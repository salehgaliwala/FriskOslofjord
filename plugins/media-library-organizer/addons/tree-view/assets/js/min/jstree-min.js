var __webpack_modules__={669:e=>{"use strict";e.exports=jQuery},695:(e,t,i)=>{var r,s,a;(function(n){"use strict";if(true){!(s=[i(669)],r=n,a=typeof r==="function"?r.apply(t,s):r,a!==undefined&&(e.exports=a))}else{}})(function(e,t){"use strict";if(e.jstree){return}var i=0,r=false,s=false,a=false,n=[],o=e("script:last").attr("src"),d=window.document;var l=window.setImmediate;var h=window.Promise;if(!l&&h){l=function(e,t){h.resolve(t).then(e)}}e.jstree={version:"3.3.9",defaults:{plugins:[]},plugins:{},path:o&&o.indexOf("/")!==-1?o.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g,root:"#"};e.jstree.create=function(t,r){var s=new e.jstree.core(++i),a=r;r=e.extend(true,{},e.jstree.defaults,r);if(a&&a.plugins){r.plugins=a.plugins}e.each(r.plugins,function(e,t){if(e!=="core"){s=s.plugin(t,r[t])}});e(t).data("jstree",s);s.init(t,r);return s};e.jstree.destroy=function(){e(".jstree:jstree").jstree("destroy");e(d).off(".jstree")};e.jstree.core=function(e){this._id=e;this._cnt=0;this._wrk=null;this._data={core:{themes:{name:false,dots:false,icons:false,ellipsis:false},selected:[],last_error:{},working:false,worker_queue:[],focused:null}}};e.jstree.reference=function(t){var i=null,r=null;if(t&&t.id&&(!t.tagName||!t.nodeType)){t=t.id}if(!r||!r.length){try{r=e(t)}catch(e){}}if(!r||!r.length){try{r=e("#"+t.replace(e.jstree.idregex,"\\$&"))}catch(e){}}if(r&&r.length&&(r=r.closest(".jstree")).length&&(r=r.data("jstree"))){i=r}else{e(".jstree").each(function(){var r=e(this).data("jstree");if(r&&r._model.data[t]){i=r;return false}})}return i};e.fn.jstree=function(i){var r=typeof i==="string",s=Array.prototype.slice.call(arguments,1),a=null;if(i===true&&!this.length){return false}this.each(function(){var n=e.jstree.reference(this),o=r&&n?n[i]:null;a=r&&o?o.apply(n,s):null;if(!n&&!r&&(i===t||e.isPlainObject(i))){e.jstree.create(this,i)}if(n&&!r||i===true){a=n||false}if(a!==null&&a!==t){return false}});return a!==null&&a!==t?a:this};e.expr.pseudos.jstree=e.expr.createPseudo(function(i){return function(i){return e(i).hasClass("jstree")&&e(i).data("jstree")!==t}});e.jstree.defaults.core={data:false,strings:false,check_callback:false,error:e.noop,animation:200,multiple:true,themes:{name:false,url:false,dir:false,dots:true,icons:true,ellipsis:false,stripes:false,variant:false,responsive:false},expand_selected_onload:true,worker:true,force_text:false,dblclick_toggle:true,loaded_state:false,restore_focus:true,keyboard:{"ctrl-space":function(t){t.type="click";e(t.currentTarget).trigger(t)},enter:function(t){t.type="click";e(t.currentTarget).trigger(t)},left:function(t){t.preventDefault();if(this.is_open(t.currentTarget)){this.close_node(t.currentTarget)}else{var i=this.get_parent(t.currentTarget);if(i&&i.id!==e.jstree.root){this.get_node(i,true).children(".jstree-anchor").focus()}}},up:function(e){e.preventDefault();var t=this.get_prev_dom(e.currentTarget);if(t&&t.length){t.children(".jstree-anchor").focus()}},right:function(t){t.preventDefault();if(this.is_closed(t.currentTarget)){this.open_node(t.currentTarget,function(e){this.get_node(e,true).children(".jstree-anchor").focus()})}else if(this.is_open(t.currentTarget)){var i=this.get_node(t.currentTarget,true).children(".jstree-children")[0];if(i){e(this._firstChild(i)).children(".jstree-anchor").focus()}}},down:function(e){e.preventDefault();var t=this.get_next_dom(e.currentTarget);if(t&&t.length){t.children(".jstree-anchor").focus()}},"*":function(e){this.open_all()},home:function(t){t.preventDefault();var i=this._firstChild(this.get_container_ul()[0]);if(i){e(i).children(".jstree-anchor").filter(":visible").focus()}},end:function(e){e.preventDefault();this.element.find(".jstree-anchor").filter(":visible").last().focus()},f2:function(e){e.preventDefault();this.edit(e.currentTarget)}}};e.jstree.core.prototype={plugin:function(t,i){var r=e.jstree.plugins[t];if(r){this._data[t]={};r.prototype=this;return new r(i,this)}return this},init:function(t,i){this._model={data:{},changed:[],force_full_redraw:false,redraw_timeout:false,default_state:{loaded:true,opened:false,selected:false,disabled:false}};this._model.data[e.jstree.root]={id:e.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:false}};this.element=e(t).addClass("jstree jstree-"+this._id);this.settings=i;this._data.core.ready=false;this._data.core.loaded=false;this._data.core.rtl=this.element.css("direction")==="rtl";this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl");this.element.attr("role","tree");if(this.settings.core.multiple){this.element.attr("aria-multiselectable",true)}if(!this.element.attr("tabindex")){this.element.attr("tabindex","0")}this.bind();this.trigger("init");this._data.core.original_container_html=this.element.find(" > ul > li").clone(true);this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return this.nodeType===3&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove();this.element.html("<"+"ul class='jstree-container-ul jstree-children' role='group'><"+"li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='treeitem'><i class='jstree-icon jstree-ocl'></i><"+"a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>");this.element.attr("aria-activedescendant","j"+this._id+"_loading");this._data.core.li_height=this.get_container_ul().children("li").first().outerHeight()||24;this._data.core.node=this._create_prototype_node();this.trigger("loading");this.load_node(e.jstree.root)},destroy:function(e){this.trigger("destroy");if(this._wrk){try{window.URL.revokeObjectURL(this._wrk);this._wrk=null}catch(e){}}if(!e){this.element.empty()}this.teardown()},_create_prototype_node:function(){var e=d.createElement("LI"),t,i;e.setAttribute("role","treeitem");t=d.createElement("I");t.className="jstree-icon jstree-ocl";t.setAttribute("role","presentation");e.appendChild(t);t=d.createElement("A");t.className="jstree-anchor";t.setAttribute("href","#");t.setAttribute("tabindex","-1");i=d.createElement("I");i.className="jstree-icon jstree-themeicon";i.setAttribute("role","presentation");t.appendChild(i);e.appendChild(t);t=i=null;return e},_kbevent_to_func:function(e){var t={8:"Backspace",9:"Tab",13:"Enter",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock",16:"Shift",17:"Ctrl",18:"Alt",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",111:"/",106:"*",173:"-"};var i=[];if(e.ctrlKey){i.push("ctrl")}if(e.altKey){i.push("alt")}if(e.shiftKey){i.push("shift")}i.push(t[e.which]||e.which);i=i.sort().join("-").toLowerCase();if(i==="shift-shift"||i==="ctrl-ctrl"||i==="alt-alt"){return null}var r=this.settings.core.keyboard,s,a;for(s in r){if(r.hasOwnProperty(s)){a=s;if(a!=="-"&&a!=="+"){a=a.replace("--","-MINUS").replace("+-","-MINUS").replace("++","-PLUS").replace("-+","-PLUS");a=a.split(/-|\+/).sort().join("-").replace("MINUS","-").replace("PLUS","+").toLowerCase()}if(a===i){return r[s]}}}return null},teardown:function(){this.unbind();this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")});this.element=null},bind:function(){var t="",i=null,r=0;this.element.on("dblclick.jstree",function(e){if(e.target.tagName&&e.target.tagName.toLowerCase()==="input"){return true}if(d.selection&&d.selection.empty){d.selection.empty()}else{if(window.getSelection){var t=window.getSelection();try{t.removeAllRanges();t.collapse()}catch(e){}}}}).on("mousedown.jstree",e.proxy(function(e){if(e.target===this.element[0]){e.preventDefault();r=+new Date}},this)).on("mousedown.jstree",".jstree-ocl",function(e){e.preventDefault()}).on("click.jstree",".jstree-ocl",e.proxy(function(e){this.toggle_node(e.target)},this)).on("dblclick.jstree",".jstree-anchor",e.proxy(function(e){if(e.target.tagName&&e.target.tagName.toLowerCase()==="input"){return true}if(this.settings.core.dblclick_toggle){this.toggle_node(e.target)}},this)).on("click.jstree",".jstree-anchor",e.proxy(function(t){t.preventDefault();if(t.currentTarget!==d.activeElement){e(t.currentTarget).focus()}this.activate_node(t.currentTarget,t)},this)).on("keydown.jstree",".jstree-anchor",e.proxy(function(e){if(e.target.tagName&&e.target.tagName.toLowerCase()==="input"){return true}if(this._data.core.rtl){if(e.which===37){e.which=39}else if(e.which===39){e.which=37}}var t=this._kbevent_to_func(e);if(t){var i=t.call(this,e);if(i===false||i===true){return i}}},this)).on("load_node.jstree",e.proxy(function(t,i){if(i.status){if(i.node.id===e.jstree.root&&!this._data.core.loaded){this._data.core.loaded=true;if(this._firstChild(this.get_container_ul()[0])){this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id)}this.trigger("loaded")}if(!this._data.core.ready){setTimeout(e.proxy(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){this._data.core.ready=true;if(this._data.core.selected.length){if(this.settings.core.expand_selected_onload){var t=[],i,r;for(i=0,r=this._data.core.selected.length;i<r;i++){t=t.concat(this._model.data[this._data.core.selected[i]].parents)}t=e.vakata.array_unique(t);for(i=0,r=t.length;i<r;i++){this.open_node(t[i],false,0)}}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}},this),0)}}},this)).on("keypress.jstree",e.proxy(function(r){if(r.target.tagName&&r.target.tagName.toLowerCase()==="input"){return true}if(i){clearTimeout(i)}i=setTimeout(function(){t=""},500);var s=String.fromCharCode(r.which).toLowerCase(),a=this.element.find(".jstree-anchor").filter(":visible"),n=a.index(d.activeElement)||0,o=false;t+=s;if(t.length>1){a.slice(n).each(e.proxy(function(i,r){if(e(r).text().toLowerCase().indexOf(t)===0){e(r).focus();o=true;return false}},this));if(o){return}a.slice(0,n).each(e.proxy(function(i,r){if(e(r).text().toLowerCase().indexOf(t)===0){e(r).focus();o=true;return false}},this));if(o){return}}if(new RegExp("^"+s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"+$").test(t)){a.slice(n+1).each(e.proxy(function(t,i){if(e(i).text().toLowerCase().charAt(0)===s){e(i).focus();o=true;return false}},this));if(o){return}a.slice(0,n+1).each(e.proxy(function(t,i){if(e(i).text().toLowerCase().charAt(0)===s){e(i).focus();o=true;return false}},this));if(o){return}}},this)).on("init.jstree",e.proxy(function(){var e=this.settings.core.themes;this._data.core.themes.dots=e.dots;this._data.core.themes.stripes=e.stripes;this._data.core.themes.icons=e.icons;this._data.core.themes.ellipsis=e.ellipsis;this.set_theme(e.name||"default",e.url);this.set_theme_variant(e.variant)},this)).on("loading.jstree",e.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"]();this[this._data.core.themes.icons?"show_icons":"hide_icons"]();this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"]();this[this._data.core.themes.ellipsis?"show_ellipsis":"hide_ellipsis"]()},this)).on("blur.jstree",".jstree-anchor",e.proxy(function(t){this._data.core.focused=null;e(t.currentTarget).filter(".jstree-hovered").trigger("mouseleave");this.element.attr("tabindex","0")},this)).on("focus.jstree",".jstree-anchor",e.proxy(function(t){var i=this.get_node(t.currentTarget);if(i&&i.id){this._data.core.focused=i.id}this.element.find(".jstree-hovered").not(t.currentTarget).trigger("mouseleave");e(t.currentTarget).trigger("mouseenter");this.element.attr("tabindex","-1")},this)).on("focus.jstree",e.proxy(function(){if(+new Date-r>500&&!this._data.core.focused&&this.settings.core.restore_focus){r=0;var e=this.get_node(this.element.attr("aria-activedescendant"),true);if(e){e.find("> .jstree-anchor").focus()}}},this)).on("mouseenter.jstree",".jstree-anchor",e.proxy(function(e){this.hover_node(e.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},unbind:function(){this.element.off(".jstree");e(d).off(".jstree-"+this._id)},trigger:function(e,t){if(!t){t={}}t.instance=this;this.element.triggerHandler(e.replace(".jstree","")+".jstree",t)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(t){var i=this.settings.core.strings;if(e.isFunction(i)){return i.call(this,t)}if(i&&i[t]){return i[t]}return t},_firstChild:function(e){e=e?e.firstChild:null;while(e!==null&&e.nodeType!==1){e=e.nextSibling}return e},_nextSibling:function(e){e=e?e.nextSibling:null;while(e!==null&&e.nodeType!==1){e=e.nextSibling}return e},_previousSibling:function(e){e=e?e.previousSibling:null;while(e!==null&&e.nodeType!==1){e=e.previousSibling}return e},get_node:function(t,i){if(t&&t.id){t=t.id}if(t instanceof e&&t.length&&t[0].id){t=t[0].id}var r;try{if(this._model.data[t]){t=this._model.data[t]}else if(typeof t==="string"&&this._model.data[t.replace(/^#/,"")]){t=this._model.data[t.replace(/^#/,"")]}else if(typeof t==="string"&&(r=e("#"+t.replace(e.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[r.closest(".jstree-node").attr("id")]){t=this._model.data[r.closest(".jstree-node").attr("id")]}else if((r=this.element.find(t)).length&&this._model.data[r.closest(".jstree-node").attr("id")]){t=this._model.data[r.closest(".jstree-node").attr("id")]}else if((r=this.element.find(t)).length&&r.hasClass("jstree")){t=this._model.data[e.jstree.root]}else{return false}if(i){t=t.id===e.jstree.root?this.element:e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)}return t}catch(e){return false}},get_path:function(t,i,r){t=t.parents?t:this.get_node(t);if(!t||t.id===e.jstree.root||!t.parents){return false}var s,a,n=[];n.push(r?t.id:t.text);for(s=0,a=t.parents.length;s<a;s++){n.push(r?t.parents[s]:this.get_text(t.parents[s]))}n=n.reverse().slice(1);return i?n.join(i):n},get_next_dom:function(t,i){var r;t=this.get_node(t,true);if(t[0]===this.element[0]){r=this._firstChild(this.get_container_ul()[0]);while(r&&r.offsetHeight===0){r=this._nextSibling(r)}return r?e(r):false}if(!t||!t.length){return false}if(i){r=t[0];do{r=this._nextSibling(r)}while(r&&r.offsetHeight===0);return r?e(r):false}if(t.hasClass("jstree-open")){r=this._firstChild(t.children(".jstree-children")[0]);while(r&&r.offsetHeight===0){r=this._nextSibling(r)}if(r!==null){return e(r)}}r=t[0];do{r=this._nextSibling(r)}while(r&&r.offsetHeight===0);if(r!==null){return e(r)}return t.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(t,i){var r;t=this.get_node(t,true);if(t[0]===this.element[0]){r=this.get_container_ul()[0].lastChild;while(r&&r.offsetHeight===0){r=this._previousSibling(r)}return r?e(r):false}if(!t||!t.length){return false}if(i){r=t[0];do{r=this._previousSibling(r)}while(r&&r.offsetHeight===0);return r?e(r):false}r=t[0];do{r=this._previousSibling(r)}while(r&&r.offsetHeight===0);if(r!==null){t=e(r);while(t.hasClass("jstree-open")){t=t.children(".jstree-children").first().children(".jstree-node:visible:last")}return t}r=t[0].parentNode.parentNode;return r&&r.className&&r.className.indexOf("jstree-node")!==-1?e(r):false},get_parent:function(t){t=this.get_node(t);if(!t||t.id===e.jstree.root){return false}return t.parent},get_children_dom:function(e){e=this.get_node(e,true);if(e[0]===this.element[0]){return this.get_container_ul().children(".jstree-node")}if(!e||!e.length){return false}return e.children(".jstree-children").children(".jstree-node")},is_parent:function(e){e=this.get_node(e);return e&&(e.state.loaded===false||e.children.length>0)},is_loaded:function(e){e=this.get_node(e);return e&&e.state.loaded},is_loading:function(e){e=this.get_node(e);return e&&e.state&&e.state.loading},is_open:function(e){e=this.get_node(e);return e&&e.state.opened},is_closed:function(e){e=this.get_node(e);return e&&this.is_parent(e)&&!e.state.opened},is_leaf:function(e){return!this.is_parent(e)},load_node:function(t,i){var r,s,a,n,o;if(e.isArray(t)){this._load_nodes(t.slice(),i);return true}t=this.get_node(t);if(!t){if(i){i.call(this,t,false)}return false}if(t.state.loaded){t.state.loaded=false;for(a=0,n=t.parents.length;a<n;a++){this._model.data[t.parents[a]].children_d=e.vakata.array_filter(this._model.data[t.parents[a]].children_d,function(i){return e.inArray(i,t.children_d)===-1})}for(r=0,s=t.children_d.length;r<s;r++){if(this._model.data[t.children_d[r]].state.selected){o=true}delete this._model.data[t.children_d[r]]}if(o){this._data.core.selected=e.vakata.array_filter(this._data.core.selected,function(i){return e.inArray(i,t.children_d)===-1})}t.children=[];t.children_d=[];if(o){this.trigger("changed",{action:"load_node",node:t,selected:this._data.core.selected})}}t.state.failed=false;t.state.loading=true;this.get_node(t,true).addClass("jstree-loading").attr("aria-busy",true);this._load_node(t,e.proxy(function(e){t=this._model.data[t.id];t.state.loading=false;t.state.loaded=e;t.state.failed=!t.state.loaded;var r=this.get_node(t,true),s=0,a=0,n=this._model.data,o=false;for(s=0,a=t.children.length;s<a;s++){if(n[t.children[s]]&&!n[t.children[s]].state.hidden){o=true;break}}if(t.state.loaded&&r&&r.length){r.removeClass("jstree-closed jstree-open jstree-leaf");if(!o){r.addClass("jstree-leaf")}else{if(t.id!=="#"){r.addClass(t.state.opened?"jstree-open":"jstree-closed")}}}r.removeClass("jstree-loading").attr("aria-busy",false);this.trigger("load_node",{node:t,status:e});if(i){i.call(this,t,e)}},this));return true},_load_nodes:function(e,t,i,r){var s=true,c=function(){this._load_nodes(e,t,true)},a=this._model.data,n,o,d=[];for(n=0,o=e.length;n<o;n++){if(a[e[n]]&&(!a[e[n]].state.loaded&&!a[e[n]].state.failed||!i&&r)){if(!this.is_loading(e[n])){this.load_node(e[n],c)}s=false}}if(s){for(n=0,o=e.length;n<o;n++){if(a[e[n]]&&a[e[n]].state.loaded){d.push(e[n])}}if(t&&!t.done){t.call(this,d);t.done=true}}},load_all:function(t,i){if(!t){t=e.jstree.root}t=this.get_node(t);if(!t){return false}var r=[],s=this._model.data,a=s[t.id].children_d,n,o;if(t.state&&!t.state.loaded){r.push(t.id)}for(n=0,o=a.length;n<o;n++){if(s[a[n]]&&s[a[n]].state&&!s[a[n]].state.loaded){r.push(a[n])}}if(r.length){this._load_nodes(r,function(){this.load_all(t,i)})}else{if(i){i.call(this,t)}this.trigger("load_all",{node:t})}},_load_node:function(t,i){var r=this.settings.core.data,s;var a=function notTextOrCommentNode(){return this.nodeType!==3&&this.nodeType!==8};if(!r){if(t.id===e.jstree.root){return this._append_html_data(t,this._data.core.original_container_html.clone(true),function(e){i.call(this,e)})}else{return i.call(this,false)}}if(e.isFunction(r)){return r.call(this,t,e.proxy(function(r){if(r===false){i.call(this,false)}else{this[typeof r==="string"?"_append_html_data":"_append_json_data"](t,typeof r==="string"?e(e.parseHTML(r)).filter(a):r,function(e){i.call(this,e)})}},this))}if(typeof r==="object"){if(r.url){r=e.extend(true,{},r);if(e.isFunction(r.url)){r.url=r.url.call(this,t)}if(e.isFunction(r.data)){r.data=r.data.call(this,t)}return e.ajax(r).done(e.proxy(function(r,s,n){var o=n.getResponseHeader("Content-Type");if(o&&o.indexOf("json")!==-1||typeof r==="object"){return this._append_json_data(t,r,function(e){i.call(this,e)})}if(o&&o.indexOf("html")!==-1||typeof r==="string"){return this._append_html_data(t,e(e.parseHTML(r)).filter(a),function(e){i.call(this,e)})}this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:n})};this.settings.core.error.call(this,this._data.core.last_error);return i.call(this,false)},this)).fail(e.proxy(function(e){this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:e})};i.call(this,false);this.settings.core.error.call(this,this._data.core.last_error)},this))}if(e.isArray(r)){s=e.extend(true,[],r)}else if(e.isPlainObject(r)){s=e.extend(true,{},r)}else{s=r}if(t.id===e.jstree.root){return this._append_json_data(t,s,function(e){i.call(this,e)})}else{this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:t.id})};this.settings.core.error.call(this,this._data.core.last_error);return i.call(this,false)}}if(typeof r==="string"){if(t.id===e.jstree.root){return this._append_html_data(t,e(e.parseHTML(r)).filter(a),function(e){i.call(this,e)})}else{this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:t.id})};this.settings.core.error.call(this,this._data.core.last_error);return i.call(this,false)}}return i.call(this,false)},_node_changed:function(t){t=this.get_node(t);if(t&&e.inArray(t.id,this._model.changed)===-1){this._model.changed.push(t.id)}},_append_html_data:function(t,i,r){t=this.get_node(t);t.children=[];t.children_d=[];var s=i.is("ul")?i.children():i,a=t.id,n=[],o=[],d=this._model.data,l=d[a],h=this._data.core.selected.length,f,_,u;s.each(e.proxy(function(t,i){f=this._parse_model_from_html(e(i),a,l.parents.concat());if(f){n.push(f);o.push(f);if(d[f].children_d.length){o=o.concat(d[f].children_d)}}},this));l.children=n;l.children_d=o;for(_=0,u=l.parents.length;_<u;_++){d[l.parents[_]].children_d=d[l.parents[_]].children_d.concat(o)}this.trigger("model",{nodes:o,parent:a});if(a!==e.jstree.root){this._node_changed(a);this.redraw()}else{this.get_container_ul().children(".jstree-initial-node").remove();this.redraw(true)}if(this._data.core.selected.length!==h){this.trigger("changed",{action:"model",selected:this._data.core.selected})}r.call(this,true)},_append_json_data:function(t,i,r,s){if(this.element===null){return}t=this.get_node(t);t.children=[];t.children_d=[];if(i.d){i=i.d;if(typeof i==="string"){i=JSON.parse(i)}}if(!e.isArray(i)){i=[i]}var a=null,n={df:this._model.default_state,dat:i,par:t.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},o=this,func=function(e,t){if(e.data){e=e.data}var i=e.dat,r=e.par,s=[],a=[],n=[],d=e.df,l=e.t_id,h=e.t_cnt,f=e.m,_=f[r],u=e.sel,g,p,m,v,parse_flat=function(e,i,r){if(!r){r=[]}else{r=r.concat()}if(i){r.unshift(i)}var s=e.id.toString(),a,o,l,h,_={id:s,text:e.text||"",icon:e.icon!==t?e.icon:true,parent:i,parents:r,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:false},a_attr:{href:"#"},original:false};for(a in d){if(d.hasOwnProperty(a)){_.state[a]=d[a]}}if(e&&e.data&&e.data.jstree&&e.data.jstree.icon){_.icon=e.data.jstree.icon}if(_.icon===t||_.icon===null||_.icon===""){_.icon=true}if(e&&e.data){_.data=e.data;if(e.data.jstree){for(a in e.data.jstree){if(e.data.jstree.hasOwnProperty(a)){_.state[a]=e.data.jstree[a]}}}}if(e&&typeof e.state==="object"){for(a in e.state){if(e.state.hasOwnProperty(a)){_.state[a]=e.state[a]}}}if(e&&typeof e.li_attr==="object"){for(a in e.li_attr){if(e.li_attr.hasOwnProperty(a)){_.li_attr[a]=e.li_attr[a]}}}if(!_.li_attr.id){_.li_attr.id=s}if(e&&typeof e.a_attr==="object"){for(a in e.a_attr){if(e.a_attr.hasOwnProperty(a)){_.a_attr[a]=e.a_attr[a]}}}if(e&&e.children&&e.children===true){_.state.loaded=false;_.children=[];_.children_d=[]}f[_.id]=_;for(a=0,o=_.children.length;a<o;a++){l=parse_flat(f[_.children[a]],_.id,r);h=f[l];_.children_d.push(l);if(h.children_d.length){_.children_d=_.children_d.concat(h.children_d)}}delete e.data;delete e.children;f[_.id].original=e;if(_.state.selected){n.push(_.id)}return _.id},parse_nest=function(e,i,r){if(!r){r=[]}else{r=r.concat()}if(i){r.unshift(i)}var s=false,a,o,_,u,g;do{s="j"+l+"_"+ ++h}while(f[s]);g={id:false,text:typeof e==="string"?e:"",icon:typeof e==="object"&&e.icon!==t?e.icon:true,parent:i,parents:r,children:[],children_d:[],data:null,state:{},li_attr:{id:false},a_attr:{href:"#"},original:false};for(a in d){if(d.hasOwnProperty(a)){g.state[a]=d[a]}}if(e&&e.id){g.id=e.id.toString()}if(e&&e.text){g.text=e.text}if(e&&e.data&&e.data.jstree&&e.data.jstree.icon){g.icon=e.data.jstree.icon}if(g.icon===t||g.icon===null||g.icon===""){g.icon=true}if(e&&e.data){g.data=e.data;if(e.data.jstree){for(a in e.data.jstree){if(e.data.jstree.hasOwnProperty(a)){g.state[a]=e.data.jstree[a]}}}}if(e&&typeof e.state==="object"){for(a in e.state){if(e.state.hasOwnProperty(a)){g.state[a]=e.state[a]}}}if(e&&typeof e.li_attr==="object"){for(a in e.li_attr){if(e.li_attr.hasOwnProperty(a)){g.li_attr[a]=e.li_attr[a]}}}if(g.li_attr.id&&!g.id){g.id=g.li_attr.id.toString()}if(!g.id){g.id=s}if(!g.li_attr.id){g.li_attr.id=g.id}if(e&&typeof e.a_attr==="object"){for(a in e.a_attr){if(e.a_attr.hasOwnProperty(a)){g.a_attr[a]=e.a_attr[a]}}}if(e&&e.children&&e.children.length){for(a=0,o=e.children.length;a<o;a++){_=parse_nest(e.children[a],g.id,r);u=f[_];g.children.push(_);if(u.children_d.length){g.children_d=g.children_d.concat(u.children_d)}}g.children_d=g.children_d.concat(g.children)}if(e&&e.children&&e.children===true){g.state.loaded=false;g.children=[];g.children_d=[]}delete e.data;delete e.children;g.original=e;f[g.id]=g;if(g.state.selected){n.push(g.id)}return g.id};if(i.length&&i[0].id!==t&&i[0].parent!==t){for(p=0,m=i.length;p<m;p++){if(!i[p].children){i[p].children=[]}if(!i[p].state){i[p].state={}}f[i[p].id.toString()]=i[p]}for(p=0,m=i.length;p<m;p++){if(!f[i[p].parent.toString()]){if(typeof o!=="undefined"){o._data.core.last_error={error:"parse",plugin:"core",id:"core_07",reason:"Node with invalid parent",data:JSON.stringify({id:i[p].id.toString(),parent:i[p].parent.toString()})};o.settings.core.error.call(o,o._data.core.last_error)}continue}f[i[p].parent.toString()].children.push(i[p].id.toString());_.children_d.push(i[p].id.toString())}for(p=0,m=_.children.length;p<m;p++){g=parse_flat(f[_.children[p]],r,_.parents.concat());a.push(g);if(f[g].children_d.length){a=a.concat(f[g].children_d)}}for(p=0,m=_.parents.length;p<m;p++){f[_.parents[p]].children_d=f[_.parents[p]].children_d.concat(a)}v={cnt:h,mod:f,sel:u,par:r,dpc:a,add:n}}else{for(p=0,m=i.length;p<m;p++){g=parse_nest(i[p],r,_.parents.concat());if(g){s.push(g);a.push(g);if(f[g].children_d.length){a=a.concat(f[g].children_d)}}}_.children=s;_.children_d=a;for(p=0,m=_.parents.length;p<m;p++){f[_.parents[p]].children_d=f[_.parents[p]].children_d.concat(a)}v={cnt:h,mod:f,sel:u,par:r,dpc:a,add:n}}if(typeof window==="undefined"||typeof window.document==="undefined"){postMessage(v)}else{return v}},rslt=function(t,i){if(this.element===null){return}this._cnt=t.cnt;var s,a=this._model.data;for(s in a){if(a.hasOwnProperty(s)&&a[s].state&&a[s].state.loading&&t.mod[s]){t.mod[s].state.loading=true}}this._model.data=t.mod;if(i){var n,d=t.add,h=t.sel,f=this._data.core.selected.slice();a=this._model.data;if(h.length!==f.length||e.vakata.array_unique(h.concat(f)).length!==h.length){for(s=0,n=h.length;s<n;s++){if(e.inArray(h[s],d)===-1&&e.inArray(h[s],f)===-1){a[h[s]].state.selected=false}}for(s=0,n=f.length;s<n;s++){if(e.inArray(f[s],h)===-1){a[f[s]].state.selected=true}}}}if(t.add.length){this._data.core.selected=this._data.core.selected.concat(t.add)}this.trigger("model",{nodes:t.dpc,parent:t.par});if(t.par!==e.jstree.root){this._node_changed(t.par);this.redraw()}else{this.redraw(true)}if(t.add.length){this.trigger("changed",{action:"model",selected:this._data.core.selected})}if(!i&&l){l(function(){r.call(o,true)})}else{r.call(o,true)}};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker){try{if(this._wrk===null){this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+func.toString()],{type:"text/javascript"}))}if(!this._data.core.working||s){this._data.core.working=true;a=new window.Worker(this._wrk);a.onmessage=e.proxy(function(e){rslt.call(this,e.data,true);try{a.terminate();a=null}catch(e){}if(this._data.core.worker_queue.length){this._append_json_data.apply(this,this._data.core.worker_queue.shift())}else{this._data.core.working=false}},this);if(!n.par){if(this._data.core.worker_queue.length){this._append_json_data.apply(this,this._data.core.worker_queue.shift())}else{this._data.core.working=false}}else{a.postMessage(n)}}else{this._data.core.worker_queue.push([t,i,r,true])}}catch(e){rslt.call(this,func(n),false);if(this._data.core.worker_queue.length){this._append_json_data.apply(this,this._data.core.worker_queue.shift())}else{this._data.core.working=false}}}else{rslt.call(this,func(n),false)}},_parse_model_from_html:function(i,r,s){if(!s){s=[]}else{s=[].concat(s)}if(r){s.unshift(r)}var a,n,o=this._model.data,d={id:false,text:false,icon:true,parent:r,parents:s,children:[],children_d:[],data:null,state:{},li_attr:{id:false},a_attr:{href:"#"},original:false},l,h,f;for(l in this._model.default_state){if(this._model.default_state.hasOwnProperty(l)){d.state[l]=this._model.default_state[l]}}h=e.vakata.attributes(i,true);e.each(h,function(t,i){i=e.trim(i);if(!i.length){return true}d.li_attr[t]=i;if(t==="id"){d.id=i.toString()}});h=i.children("a").first();if(h.length){h=e.vakata.attributes(h,true);e.each(h,function(t,i){i=e.trim(i);if(i.length){d.a_attr[t]=i}})}h=i.children("a").first().length?i.children("a").first().clone():i.clone();h.children("ins, i, ul").remove();h=h.html();h=e("<div />").html(h);d.text=this.settings.core.force_text?h.text():h.html();h=i.data();d.data=h?e.extend(true,{},h):null;d.state.opened=i.hasClass("jstree-open");d.state.selected=i.children("a").hasClass("jstree-clicked");d.state.disabled=i.children("a").hasClass("jstree-disabled");if(d.data&&d.data.jstree){for(l in d.data.jstree){if(d.data.jstree.hasOwnProperty(l)){d.state[l]=d.data.jstree[l]}}}h=i.children("a").children(".jstree-themeicon");if(h.length){d.icon=h.hasClass("jstree-themeicon-hidden")?false:h.attr("rel")}if(d.state.icon!==t){d.icon=d.state.icon}if(d.icon===t||d.icon===null||d.icon===""){d.icon=true}h=i.children("ul").children("li");do{f="j"+this._id+"_"+ ++this._cnt}while(o[f]);d.id=d.li_attr.id?d.li_attr.id.toString():f;if(h.length){h.each(e.proxy(function(t,i){a=this._parse_model_from_html(e(i),d.id,s);n=this._model.data[a];d.children.push(a);if(n.children_d.length){d.children_d=d.children_d.concat(n.children_d)}},this));d.children_d=d.children_d.concat(d.children)}else{if(i.hasClass("jstree-closed")){d.state.loaded=false}}if(d.li_attr["class"]){d.li_attr["class"]=d.li_attr["class"].replace("jstree-closed","").replace("jstree-open","")}if(d.a_attr["class"]){d.a_attr["class"]=d.a_attr["class"].replace("jstree-clicked","").replace("jstree-disabled","")}o[d.id]=d;if(d.state.selected){this._data.core.selected.push(d.id)}return d.id},_parse_model_from_flat_json:function(e,i,r){if(!r){r=[]}else{r=r.concat()}if(i){r.unshift(i)}var s=e.id.toString(),a=this._model.data,n=this._model.default_state,o,d,l,h,f={id:s,text:e.text||"",icon:e.icon!==t?e.icon:true,parent:i,parents:r,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:false},a_attr:{href:"#"},original:false};for(o in n){if(n.hasOwnProperty(o)){f.state[o]=n[o]}}if(e&&e.data&&e.data.jstree&&e.data.jstree.icon){f.icon=e.data.jstree.icon}if(f.icon===t||f.icon===null||f.icon===""){f.icon=true}if(e&&e.data){f.data=e.data;if(e.data.jstree){for(o in e.data.jstree){if(e.data.jstree.hasOwnProperty(o)){f.state[o]=e.data.jstree[o]}}}}if(e&&typeof e.state==="object"){for(o in e.state){if(e.state.hasOwnProperty(o)){f.state[o]=e.state[o]}}}if(e&&typeof e.li_attr==="object"){for(o in e.li_attr){if(e.li_attr.hasOwnProperty(o)){f.li_attr[o]=e.li_attr[o]}}}if(!f.li_attr.id){f.li_attr.id=s}if(e&&typeof e.a_attr==="object"){for(o in e.a_attr){if(e.a_attr.hasOwnProperty(o)){f.a_attr[o]=e.a_attr[o]}}}if(e&&e.children&&e.children===true){f.state.loaded=false;f.children=[];f.children_d=[]}a[f.id]=f;for(o=0,d=f.children.length;o<d;o++){l=this._parse_model_from_flat_json(a[f.children[o]],f.id,r);h=a[l];f.children_d.push(l);if(h.children_d.length){f.children_d=f.children_d.concat(h.children_d)}}delete e.data;delete e.children;a[f.id].original=e;if(f.state.selected){this._data.core.selected.push(f.id)}return f.id},_parse_model_from_json:function(e,i,r){if(!r){r=[]}else{r=r.concat()}if(i){r.unshift(i)}var s=false,a,n,o,d,l=this._model.data,h=this._model.default_state,f;do{s="j"+this._id+"_"+ ++this._cnt}while(l[s]);f={id:false,text:typeof e==="string"?e:"",icon:typeof e==="object"&&e.icon!==t?e.icon:true,parent:i,parents:r,children:[],children_d:[],data:null,state:{},li_attr:{id:false},a_attr:{href:"#"},original:false};for(a in h){if(h.hasOwnProperty(a)){f.state[a]=h[a]}}if(e&&e.id){f.id=e.id.toString()}if(e&&e.text){f.text=e.text}if(e&&e.data&&e.data.jstree&&e.data.jstree.icon){f.icon=e.data.jstree.icon}if(f.icon===t||f.icon===null||f.icon===""){f.icon=true}if(e&&e.data){f.data=e.data;if(e.data.jstree){for(a in e.data.jstree){if(e.data.jstree.hasOwnProperty(a)){f.state[a]=e.data.jstree[a]}}}}if(e&&typeof e.state==="object"){for(a in e.state){if(e.state.hasOwnProperty(a)){f.state[a]=e.state[a]}}}if(e&&typeof e.li_attr==="object"){for(a in e.li_attr){if(e.li_attr.hasOwnProperty(a)){f.li_attr[a]=e.li_attr[a]}}}if(f.li_attr.id&&!f.id){f.id=f.li_attr.id.toString()}if(!f.id){f.id=s}if(!f.li_attr.id){f.li_attr.id=f.id}if(e&&typeof e.a_attr==="object"){for(a in e.a_attr){if(e.a_attr.hasOwnProperty(a)){f.a_attr[a]=e.a_attr[a]}}}if(e&&e.children&&e.children.length){for(a=0,n=e.children.length;a<n;a++){o=this._parse_model_from_json(e.children[a],f.id,r);d=l[o];f.children.push(o);if(d.children_d.length){f.children_d=f.children_d.concat(d.children_d)}}f.children_d=f.children.concat(f.children_d)}if(e&&e.children&&e.children===true){f.state.loaded=false;f.children=[];f.children_d=[]}delete e.data;delete e.children;f.original=e;l[f.id]=f;if(f.state.selected){this._data.core.selected.push(f.id)}return f.id},_redraw:function(){var t=this._model.force_full_redraw?this._model.data[e.jstree.root].children.concat([]):this._model.changed.concat([]),i=d.createElement("UL"),r,s,a,n=this._data.core.focused;for(s=0,a=t.length;s<a;s++){r=this.redraw_node(t[s],true,this._model.force_full_redraw);if(r&&this._model.force_full_redraw){i.appendChild(r)}}if(this._model.force_full_redraw){i.className=this.get_container_ul()[0].className;i.setAttribute("role","group");this.element.empty().append(i)}if(n!==null&&this.settings.core.restore_focus){r=this.get_node(n,true);if(r&&r.length&&r.children(".jstree-anchor")[0]!==d.activeElement){r.children(".jstree-anchor").focus()}else{this._data.core.focused=null}}this._model.force_full_redraw=false;this._model.changed=[];this.trigger("redraw",{nodes:t})},redraw:function(e){if(e){this._model.force_full_redraw=true}this._redraw()},draw_children:function(t){var i=this.get_node(t),r=false,s=false,a=false,n=d;if(!i){return false}if(i.id===e.jstree.root){return this.redraw(true)}t=this.get_node(t,true);if(!t||!t.length){return false}t.children(".jstree-children").remove();t=t[0];if(i.children.length&&i.state.loaded){a=n.createElement("UL");a.setAttribute("role","group");a.className="jstree-children";for(r=0,s=i.children.length;r<s;r++){a.appendChild(this.redraw_node(i.children[r],true,true))}t.appendChild(a)}},redraw_node:function(t,i,r,s){var a=this.get_node(t),n=false,o=false,l=false,h=false,f=false,_=false,u="",g=d,p=this._model.data,m=false,v=false,j=null,k=0,y=0,x=false,b=false;if(!a){return false}if(a.id===e.jstree.root){return this.redraw(true)}i=i||a.children.length===0;t=!d.querySelector?d.getElementById(a.id):this.element[0].querySelector("#"+("0123456789".indexOf(a.id[0])!==-1?"\\3"+a.id[0]+" "+a.id.substr(1).replace(e.jstree.idregex,"\\$&"):a.id.replace(e.jstree.idregex,"\\$&")));if(!t){i=true;if(!r){n=a.parent!==e.jstree.root?e("#"+a.parent.replace(e.jstree.idregex,"\\$&"),this.element)[0]:null;if(n!==null&&(!n||!p[a.parent].state.opened)){return false}o=e.inArray(a.id,n===null?p[e.jstree.root].children:p[a.parent].children)}}else{t=e(t);if(!r){n=t.parent().parent()[0];if(n===this.element[0]){n=null}o=t.index()}if(!i&&a.children.length&&!t.children(".jstree-children").length){i=true}if(!i){l=t.children(".jstree-children")[0]}m=t.children(".jstree-anchor")[0]===d.activeElement;t.remove()}t=this._data.core.node.cloneNode(true);u="jstree-node ";for(h in a.li_attr){if(a.li_attr.hasOwnProperty(h)){if(h==="id"){continue}if(h!=="class"){t.setAttribute(h,a.li_attr[h])}else{u+=a.li_attr[h]}}}if(!a.a_attr.id){a.a_attr.id=a.id+"_anchor"}t.setAttribute("aria-selected",!!a.state.selected);t.setAttribute("aria-level",a.parents.length);t.setAttribute("aria-labelledby",a.a_attr.id);if(a.state.disabled){t.setAttribute("aria-disabled",true)}for(h=0,f=a.children.length;h<f;h++){if(!p[a.children[h]].state.hidden){x=true;break}}if(a.parent!==null&&p[a.parent]&&!a.state.hidden){h=e.inArray(a.id,p[a.parent].children);b=a.id;if(h!==-1){h++;for(f=p[a.parent].children.length;h<f;h++){if(!p[p[a.parent].children[h]].state.hidden){b=p[a.parent].children[h]}if(b!==a.id){break}}}}if(a.state.hidden){u+=" jstree-hidden"}if(a.state.loading){u+=" jstree-loading"}if(a.state.loaded&&!x){u+=" jstree-leaf"}else{u+=a.state.opened&&a.state.loaded?" jstree-open":" jstree-closed";t.setAttribute("aria-expanded",a.state.opened&&a.state.loaded)}if(b===a.id){u+=" jstree-last"}t.id=a.id;t.className=u;u=(a.state.selected?" jstree-clicked":"")+(a.state.disabled?" jstree-disabled":"");for(f in a.a_attr){if(a.a_attr.hasOwnProperty(f)){if(f==="href"&&a.a_attr[f]==="#"){continue}if(f!=="class"){t.childNodes[1].setAttribute(f,a.a_attr[f])}else{u+=" "+a.a_attr[f]}}}if(u.length){t.childNodes[1].className="jstree-anchor "+u}if(a.icon&&a.icon!==true||a.icon===false){if(a.icon===false){t.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden"}else if(a.icon.indexOf("/")===-1&&a.icon.indexOf(".")===-1){t.childNodes[1].childNodes[0].className+=" "+a.icon+" jstree-themeicon-custom"}else{t.childNodes[1].childNodes[0].style.backgroundImage='url("'+a.icon+'")';t.childNodes[1].childNodes[0].style.backgroundPosition="center center";t.childNodes[1].childNodes[0].style.backgroundSize="auto";t.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom"}}if(this.settings.core.force_text){t.childNodes[1].appendChild(g.createTextNode(a.text))}else{t.childNodes[1].innerHTML+=a.text}if(i&&a.children.length&&(a.state.opened||s)&&a.state.loaded){_=g.createElement("UL");_.setAttribute("role","group");_.className="jstree-children";for(h=0,f=a.children.length;h<f;h++){_.appendChild(this.redraw_node(a.children[h],i,true))}t.appendChild(_)}if(l){t.appendChild(l)}if(!r){if(!n){n=this.element[0]}for(h=0,f=n.childNodes.length;h<f;h++){if(n.childNodes[h]&&n.childNodes[h].className&&n.childNodes[h].className.indexOf("jstree-children")!==-1){j=n.childNodes[h];break}}if(!j){j=g.createElement("UL");j.setAttribute("role","group");j.className="jstree-children";n.appendChild(j)}n=j;if(o<n.childNodes.length){n.insertBefore(t,n.childNodes[o])}else{n.appendChild(t)}if(m){k=this.element[0].scrollTop;y=this.element[0].scrollLeft;t.childNodes[1].focus();this.element[0].scrollTop=k;this.element[0].scrollLeft=y}}if(a.state.opened&&!a.state.loaded){a.state.opened=false;setTimeout(e.proxy(function(){this.open_node(a.id,false,0)},this),0)}return t},open_node:function(i,r,s){var a,n,o,d;if(e.isArray(i)){i=i.slice();for(a=0,n=i.length;a<n;a++){this.open_node(i[a],r,s)}return true}i=this.get_node(i);if(!i||i.id===e.jstree.root){return false}s=s===t?this.settings.core.animation:s;if(!this.is_closed(i)){if(r){r.call(this,i,false)}return false}if(!this.is_loaded(i)){if(this.is_loading(i)){return setTimeout(e.proxy(function(){this.open_node(i,r,s)},this),500)}this.load_node(i,function(e,t){return t?this.open_node(e,r,s):r?r.call(this,e,false):false})}else{o=this.get_node(i,true);d=this;if(o.length){if(s&&o.children(".jstree-children").length){o.children(".jstree-children").stop(true,true)}if(i.children.length&&!this._firstChild(o.children(".jstree-children")[0])){this.draw_children(i)}if(!s){this.trigger("before_open",{node:i});o[0].className=o[0].className.replace("jstree-closed","jstree-open");o[0].setAttribute("aria-expanded",true)}else{this.trigger("before_open",{node:i});o.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded",true).children(".jstree-children").stop(true,true).slideDown(s,function(){this.style.display="";if(d.element){d.trigger("after_open",{node:i})}})}}i.state.opened=true;if(r){r.call(this,i,true)}if(!o.length){this.trigger("before_open",{node:i})}this.trigger("open_node",{node:i});if(!s||!o.length){this.trigger("after_open",{node:i})}return true}},_open_to:function(t){t=this.get_node(t);if(!t||t.id===e.jstree.root){return false}var i,r,s=t.parents;for(i=0,r=s.length;i<r;i+=1){if(i!==e.jstree.root){this.open_node(s[i],false,0)}}return e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)},close_node:function(i,r){var s,a,n,o;if(e.isArray(i)){i=i.slice();for(s=0,a=i.length;s<a;s++){this.close_node(i[s],r)}return true}i=this.get_node(i);if(!i||i.id===e.jstree.root){return false}if(this.is_closed(i)){return false}r=r===t?this.settings.core.animation:r;n=this;o=this.get_node(i,true);i.state.opened=false;this.trigger("close_node",{node:i});if(!o.length){this.trigger("after_close",{node:i})}else{if(!r){o[0].className=o[0].className.replace("jstree-open","jstree-closed");o.attr("aria-expanded",false).children(".jstree-children").remove();this.trigger("after_close",{node:i})}else{o.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded",false).children(".jstree-children").stop(true,true).slideUp(r,function(){this.style.display="";o.children(".jstree-children").remove();if(n.element){n.trigger("after_close",{node:i})}})}}},toggle_node:function(t){var i,r;if(e.isArray(t)){t=t.slice();for(i=0,r=t.length;i<r;i++){this.toggle_node(t[i])}return true}if(this.is_closed(t)){return this.open_node(t)}if(this.is_open(t)){return this.close_node(t)}},open_all:function(t,i,r){if(!t){t=e.jstree.root}t=this.get_node(t);if(!t){return false}var s=t.id===e.jstree.root?this.get_container_ul():this.get_node(t,true),a,n,o;if(!s.length){for(a=0,n=t.children_d.length;a<n;a++){if(this.is_closed(this._model.data[t.children_d[a]])){this._model.data[t.children_d[a]].state.opened=true}}return this.trigger("open_all",{node:t})}r=r||s;o=this;s=this.is_closed(t)?s.find(".jstree-closed").addBack():s.find(".jstree-closed");s.each(function(){o.open_node(this,function(e,t){if(t&&this.is_parent(e)){this.open_all(e,i,r)}},i||0)});if(r.find(".jstree-closed").length===0){this.trigger("open_all",{node:this.get_node(r)})}},close_all:function(t,i){if(!t){t=e.jstree.root}t=this.get_node(t);if(!t){return false}var r=t.id===e.jstree.root?this.get_container_ul():this.get_node(t,true),s=this,a,n;if(r.length){r=this.is_open(t)?r.find(".jstree-open").addBack():r.find(".jstree-open");e(r.get().reverse()).each(function(){s.close_node(this,i||0)})}for(a=0,n=t.children_d.length;a<n;a++){this._model.data[t.children_d[a]].state.opened=false}this.trigger("close_all",{node:t})},is_disabled:function(e){e=this.get_node(e);return e&&e.state&&e.state.disabled},enable_node:function(t){var i,r;if(e.isArray(t)){t=t.slice();for(i=0,r=t.length;i<r;i++){this.enable_node(t[i])}return true}t=this.get_node(t);if(!t||t.id===e.jstree.root){return false}t.state.disabled=false;this.get_node(t,true).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",false);this.trigger("enable_node",{node:t})},disable_node:function(t){var i,r;if(e.isArray(t)){t=t.slice();for(i=0,r=t.length;i<r;i++){this.disable_node(t[i])}return true}t=this.get_node(t);if(!t||t.id===e.jstree.root){return false}t.state.disabled=true;this.get_node(t,true).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",true);this.trigger("disable_node",{node:t})},is_hidden:function(e){e=this.get_node(e);return e.state.hidden===true},hide_node:function(t,i){var r,s;if(e.isArray(t)){t=t.slice();for(r=0,s=t.length;r<s;r++){this.hide_node(t[r],true)}if(!i){this.redraw()}return true}t=this.get_node(t);if(!t||t.id===e.jstree.root){return false}if(!t.state.hidden){t.state.hidden=true;this._node_changed(t.parent);if(!i){this.redraw()}this.trigger("hide_node",{node:t})}},show_node:function(t,i){var r,s;if(e.isArray(t)){t=t.slice();for(r=0,s=t.length;r<s;r++){this.show_node(t[r],true)}if(!i){this.redraw()}return true}t=this.get_node(t);if(!t||t.id===e.jstree.root){return false}if(t.state.hidden){t.state.hidden=false;this._node_changed(t.parent);if(!i){this.redraw()}this.trigger("show_node",{node:t})}},hide_all:function(t){var i,r=this._model.data,s=[];for(i in r){if(r.hasOwnProperty(i)&&i!==e.jstree.root&&!r[i].state.hidden){r[i].state.hidden=true;s.push(i)}}this._model.force_full_redraw=true;if(!t){this.redraw()}this.trigger("hide_all",{nodes:s});return s},show_all:function(t){var i,r=this._model.data,s=[];for(i in r){if(r.hasOwnProperty(i)&&i!==e.jstree.root&&r[i].state.hidden){r[i].state.hidden=false;s.push(i)}}this._model.force_full_redraw=true;if(!t){this.redraw()}this.trigger("show_all",{nodes:s});return s},activate_node:function(e,i){if(this.is_disabled(e)){return false}if(!i||typeof i!=="object"){i={}}this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==t?this.get_node(this._data.core.last_clicked.id):null;if(this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected){this._data.core.last_clicked=null}if(!this._data.core.last_clicked&&this._data.core.selected.length){this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])}if(!this.settings.core.multiple||!i.metaKey&&!i.ctrlKey&&!i.shiftKey||i.shiftKey&&(!this._data.core.last_clicked||!this.get_parent(e)||this.get_parent(e)!==this._data.core.last_clicked.parent)){if(!this.settings.core.multiple&&(i.metaKey||i.ctrlKey||i.shiftKey)&&this.is_selected(e)){this.deselect_node(e,false,i)}else{this.deselect_all(true);this.select_node(e,false,false,i);this._data.core.last_clicked=this.get_node(e)}}else{if(i.shiftKey){var r=this.get_node(e).id,s=this._data.core.last_clicked.id,a=this.get_node(this._data.core.last_clicked.parent).children,n=false,o,d;for(o=0,d=a.length;o<d;o+=1){if(a[o]===r){n=!n}if(a[o]===s){n=!n}if(!this.is_disabled(a[o])&&(n||a[o]===r||a[o]===s)){if(!this.is_hidden(a[o])){this.select_node(a[o],true,false,i)}}else{this.deselect_node(a[o],true,i)}}this.trigger("changed",{action:"select_node",node:this.get_node(e),selected:this._data.core.selected,event:i})}else{if(!this.is_selected(e)){this.select_node(e,false,false,i)}else{this.deselect_node(e,false,i)}}}this.trigger("activate_node",{node:this.get_node(e),event:i})},hover_node:function(e){e=this.get_node(e,true);if(!e||!e.length||e.children(".jstree-hovered").length){return false}var t=this.element.find(".jstree-hovered"),i=this.element;if(t&&t.length){this.dehover_node(t)}e.children(".jstree-anchor").addClass("jstree-hovered");this.trigger("hover_node",{node:this.get_node(e)});setTimeout(function(){i.attr("aria-activedescendant",e[0].id)},0)},dehover_node:function(e){e=this.get_node(e,true);if(!e||!e.length||!e.children(".jstree-hovered").length){return false}e.children(".jstree-anchor").removeClass("jstree-hovered");this.trigger("dehover_node",{node:this.get_node(e)})},select_node:function(t,i,r,s){var a,n,o,d;if(e.isArray(t)){t=t.slice();for(n=0,o=t.length;n<o;n++){this.select_node(t[n],i,r,s)}return true}t=this.get_node(t);if(!t||t.id===e.jstree.root){return false}a=this.get_node(t,true);if(!t.state.selected){t.state.selected=true;this._data.core.selected.push(t.id);if(!r){a=this._open_to(t)}if(a&&a.length){a.attr("aria-selected",true).children(".jstree-anchor").addClass("jstree-clicked")}this.trigger("select_node",{node:t,selected:this._data.core.selected,event:s});if(!i){this.trigger("changed",{action:"select_node",node:t,selected:this._data.core.selected,event:s})}}},deselect_node:function(t,i,r){var s,a,n;if(e.isArray(t)){t=t.slice();for(s=0,a=t.length;s<a;s++){this.deselect_node(t[s],i,r)}return true}t=this.get_node(t);if(!t||t.id===e.jstree.root){return false}n=this.get_node(t,true);if(t.state.selected){t.state.selected=false;this._data.core.selected=e.vakata.array_remove_item(this._data.core.selected,t.id);if(n.length){n.attr("aria-selected",false).children(".jstree-anchor").removeClass("jstree-clicked")}this.trigger("deselect_node",{node:t,selected:this._data.core.selected,event:r});if(!i){this.trigger("changed",{action:"deselect_node",node:t,selected:this._data.core.selected,event:r})}}},select_all:function(t){var i=this._data.core.selected.concat([]),r,s;this._data.core.selected=this._model.data[e.jstree.root].children_d.concat();for(r=0,s=this._data.core.selected.length;r<s;r++){if(this._model.data[this._data.core.selected[r]]){this._model.data[this._data.core.selected[r]].state.selected=true}}this.redraw(true);this.trigger("select_all",{selected:this._data.core.selected});if(!t){this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:i})}},deselect_all:function(e){var t=this._data.core.selected.concat([]),i,r;for(i=0,r=this._data.core.selected.length;i<r;i++){if(this._model.data[this._data.core.selected[i]]){this._model.data[this._data.core.selected[i]].state.selected=false}}this._data.core.selected=[];this.element.find(".jstree-clicked").removeClass("jstree-clicked").parent().attr("aria-selected",false);this.trigger("deselect_all",{selected:this._data.core.selected,node:t});if(!e){this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:t})}},is_selected:function(t){t=this.get_node(t);if(!t||t.id===e.jstree.root){return false}return t.state.selected},get_selected:function(t){return t?e.map(this._data.core.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.core.selected.slice()},get_top_selected:function(t){var i=this.get_selected(true),r={},s,a,n,o;for(s=0,a=i.length;s<a;s++){r[i[s].id]=i[s]}for(s=0,a=i.length;s<a;s++){for(n=0,o=i[s].children_d.length;n<o;n++){if(r[i[s].children_d[n]]){delete r[i[s].children_d[n]]}}}i=[];for(s in r){if(r.hasOwnProperty(s)){i.push(s)}}return t?e.map(i,e.proxy(function(e){return this.get_node(e)},this)):i},get_bottom_selected:function(t){var i=this.get_selected(true),r=[],s,a;for(s=0,a=i.length;s<a;s++){if(!i[s].children.length){r.push(i[s].id)}}return t?e.map(r,e.proxy(function(e){return this.get_node(e)},this)):r},get_state:function(){var t={core:{open:[],loaded:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}},i;for(i in this._model.data){if(this._model.data.hasOwnProperty(i)){if(i!==e.jstree.root){if(this._model.data[i].state.loaded&&this.settings.core.loaded_state){t.core.loaded.push(i)}if(this._model.data[i].state.opened){t.core.open.push(i)}if(this._model.data[i].state.selected){t.core.selected.push(i)}}}}return t},set_state:function(i,r){if(i){if(i.core&&i.core.selected&&i.core.initial_selection===t){i.core.initial_selection=this._data.core.selected.concat([]).sort().join(",")}if(i.core){var s,a,n,o,d;if(i.core.loaded){if(!this.settings.core.loaded_state||!e.isArray(i.core.loaded)||!i.core.loaded.length){delete i.core.loaded;this.set_state(i,r)}else{this._load_nodes(i.core.loaded,function(e){delete i.core.loaded;this.set_state(i,r)})}return false}if(i.core.open){if(!e.isArray(i.core.open)||!i.core.open.length){delete i.core.open;this.set_state(i,r)}else{this._load_nodes(i.core.open,function(e){this.open_node(e,false,0);delete i.core.open;this.set_state(i,r)})}return false}if(i.core.scroll){if(i.core.scroll&&i.core.scroll.left!==t){this.element.scrollLeft(i.core.scroll.left)}if(i.core.scroll&&i.core.scroll.top!==t){this.element.scrollTop(i.core.scroll.top)}delete i.core.scroll;this.set_state(i,r);return false}if(i.core.selected){o=this;if(i.core.initial_selection===t||i.core.initial_selection===this._data.core.selected.concat([]).sort().join(",")){this.deselect_all();e.each(i.core.selected,function(e,t){o.select_node(t,false,true)})}delete i.core.initial_selection;delete i.core.selected;this.set_state(i,r);return false}for(d in i){if(i.hasOwnProperty(d)&&d!=="core"&&e.inArray(d,this.settings.plugins)===-1){delete i[d]}}if(e.isEmptyObject(i.core)){delete i.core;this.set_state(i,r);return false}}if(e.isEmptyObject(i)){i=null;if(r){r.call(this)}this.trigger("set_state");return false}return true}return false},refresh:function(t,i){this._data.core.state=i===true?{}:this.get_state();if(i&&e.isFunction(i)){this._data.core.state=i.call(this,this._data.core.state)}this._cnt=0;this._model.data={};this._model.data[e.jstree.root]={id:e.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:false}};this._data.core.selected=[];this._data.core.last_clicked=null;this._data.core.focused=null;var r=this.get_container_ul()[0].className;if(!t){this.element.html("<"+"ul class='"+r+"' role='group'><"+"li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='treeitem' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><"+"a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>");this.element.attr("aria-activedescendant","j"+this._id+"_loading")}this.load_node(e.jstree.root,function(t,i){if(i){this.get_container_ul()[0].className=r;if(this._firstChild(this.get_container_ul()[0])){this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id)}this.set_state(e.extend(true,{},this._data.core.state),function(){this.trigger("refresh")})}this._data.core.state=null})},refresh_node:function(t){t=this.get_node(t);if(!t||t.id===e.jstree.root){return false}var i=[],r=[],s=this._data.core.selected.concat([]);r.push(t.id);if(t.state.opened===true){i.push(t.id)}this.get_node(t,true).find(".jstree-open").each(function(){r.push(this.id);i.push(this.id)});this._load_nodes(r,e.proxy(function(e){this.open_node(i,false,0);this.select_node(s);this.trigger("refresh_node",{node:t,nodes:e})},this),false,true)},set_id:function(t,i){t=this.get_node(t);if(!t||t.id===e.jstree.root){return false}var r,s,a=this._model.data,n=t.id;i=i.toString();a[t.parent].children[e.inArray(t.id,a[t.parent].children)]=i;for(r=0,s=t.parents.length;r<s;r++){a[t.parents[r]].children_d[e.inArray(t.id,a[t.parents[r]].children_d)]=i}for(r=0,s=t.children.length;r<s;r++){a[t.children[r]].parent=i}for(r=0,s=t.children_d.length;r<s;r++){a[t.children_d[r]].parents[e.inArray(t.id,a[t.children_d[r]].parents)]=i}r=e.inArray(t.id,this._data.core.selected);if(r!==-1){this._data.core.selected[r]=i}r=this.get_node(t.id,true);if(r){r.attr("id",i);if(this.element.attr("aria-activedescendant")===t.id){this.element.attr("aria-activedescendant",i)}}delete a[t.id];t.id=i;t.li_attr.id=i;a[i]=t;this.trigger("set_id",{node:t,new:t.id,old:n});return true},get_text:function(t){t=this.get_node(t);return!t||t.id===e.jstree.root?false:t.text},set_text:function(t,i){var r,s;if(e.isArray(t)){t=t.slice();for(r=0,s=t.length;r<s;r++){this.set_text(t[r],i)}return true}t=this.get_node(t);if(!t||t.id===e.jstree.root){return false}t.text=i;if(this.get_node(t,true).length){this.redraw_node(t.id)}this.trigger("set_text",{obj:t,text:i});return true},get_json:function(t,i,r){t=this.get_node(t||e.jstree.root);if(!t){return false}if(i&&i.flat&&!r){r=[]}var s={id:t.id,text:t.text,icon:this.get_icon(t),li_attr:e.extend(true,{},t.li_attr),a_attr:e.extend(true,{},t.a_attr),state:{},data:i&&i.no_data?false:e.extend(true,e.isArray(t.data)?[]:{},t.data)},a,n;if(i&&i.flat){s.parent=t.parent}else{s.children=[]}if(!i||!i.no_state){for(a in t.state){if(t.state.hasOwnProperty(a)){s.state[a]=t.state[a]}}}else{delete s.state}if(i&&i.no_li_attr){delete s.li_attr}if(i&&i.no_a_attr){delete s.a_attr}if(i&&i.no_id){delete s.id;if(s.li_attr&&s.li_attr.id){delete s.li_attr.id}if(s.a_attr&&s.a_attr.id){delete s.a_attr.id}}if(i&&i.flat&&t.id!==e.jstree.root){r.push(s)}if(!i||!i.no_children){for(a=0,n=t.children.length;a<n;a++){if(i&&i.flat){this.get_json(t.children[a],i,r)}else{s.children.push(this.get_json(t.children[a],i))}}}return i&&i.flat?r:t.id===e.jstree.root?s.children:s},create_node:function(i,r,s,a,n){if(i===null){i=e.jstree.root}i=this.get_node(i);if(!i){return false}s=s===t?"last":s;if(!s.toString().match(/^(before|after)$/)&&!n&&!this.is_loaded(i)){return this.load_node(i,function(){this.create_node(i,r,s,a,true)})}if(!r){r={text:this.get_string("New node")}}if(typeof r==="string"){r={text:r}}else{r=e.extend(true,{},r)}if(r.text===t){r.text=this.get_string("New node")}var o,d,l,h;if(i.id===e.jstree.root){if(s==="before"){s="first"}if(s==="after"){s="last"}}switch(s){case"before":o=this.get_node(i.parent);s=e.inArray(i.id,o.children);i=o;break;case"after":o=this.get_node(i.parent);s=e.inArray(i.id,o.children)+1;i=o;break;case"inside":case"first":s=0;break;case"last":s=i.children.length;break;default:if(!s){s=0}break}if(s>i.children.length){s=i.children.length}if(!r.id){r.id=true}if(!this.check("create_node",r,i,s)){this.settings.core.error.call(this,this._data.core.last_error);return false}if(r.id===true){delete r.id}r=this._parse_model_from_json(r,i.id,i.parents.concat());if(!r){return false}o=this.get_node(r);d=[];d.push(r);d=d.concat(o.children_d);this.trigger("model",{nodes:d,parent:i.id});i.children_d=i.children_d.concat(d);for(l=0,h=i.parents.length;l<h;l++){this._model.data[i.parents[l]].children_d=this._model.data[i.parents[l]].children_d.concat(d)}r=o;o=[];for(l=0,h=i.children.length;l<h;l++){o[l>=s?l+1:l]=i.children[l]}o[s]=r.id;i.children=o;this.redraw_node(i,true);this.trigger("create_node",{node:this.get_node(r),parent:i.id,position:s});if(a){a.call(this,this.get_node(r))}return r.id},rename_node:function(t,i){var r,s,a;if(e.isArray(t)){t=t.slice();for(r=0,s=t.length;r<s;r++){this.rename_node(t[r],i)}return true}t=this.get_node(t);if(!t||t.id===e.jstree.root){return false}a=t.text;if(!this.check("rename_node",t,this.get_parent(t),i)){this.settings.core.error.call(this,this._data.core.last_error);return false}this.set_text(t,i);this.trigger("rename_node",{node:t,text:i,old:a});return true},delete_node:function(t){var i,r,s,a,n,o,d,l,h,f,_,u;if(e.isArray(t)){t=t.slice();for(i=0,r=t.length;i<r;i++){this.delete_node(t[i])}return true}t=this.get_node(t);if(!t||t.id===e.jstree.root){return false}s=this.get_node(t.parent);a=e.inArray(t.id,s.children);f=false;if(!this.check("delete_node",t,s,a)){this.settings.core.error.call(this,this._data.core.last_error);return false}if(a!==-1){s.children=e.vakata.array_remove(s.children,a)}n=t.children_d.concat([]);n.push(t.id);for(o=0,d=t.parents.length;o<d;o++){this._model.data[t.parents[o]].children_d=e.vakata.array_filter(this._model.data[t.parents[o]].children_d,function(t){return e.inArray(t,n)===-1})}for(l=0,h=n.length;l<h;l++){if(this._model.data[n[l]].state.selected){f=true;break}}if(f){this._data.core.selected=e.vakata.array_filter(this._data.core.selected,function(t){return e.inArray(t,n)===-1})}this.trigger("delete_node",{node:t,parent:s.id});if(f){this.trigger("changed",{action:"delete_node",node:t,selected:this._data.core.selected,parent:s.id})}for(l=0,h=n.length;l<h;l++){delete this._model.data[n[l]]}if(e.inArray(this._data.core.focused,n)!==-1){this._data.core.focused=null;_=this.element[0].scrollTop;u=this.element[0].scrollLeft;if(s.id===e.jstree.root){if(this._model.data[e.jstree.root].children[0]){this.get_node(this._model.data[e.jstree.root].children[0],true).children(".jstree-anchor").focus()}}else{this.get_node(s,true).children(".jstree-anchor").focus()}this.element[0].scrollTop=_;this.element[0].scrollLeft=u}this.redraw_node(s,true);return true},check:function(t,i,r,s,a){i=i&&i.id?i:this.get_node(i);r=r&&r.id?r:this.get_node(r);var n=t.match(/^move_node|copy_node|create_node$/i)?r:i,o=this.settings.core.check_callback;if(t==="move_node"||t==="copy_node"){if((!a||!a.is_multi)&&t==="move_node"&&e.inArray(i.id,r.children)===s){this._data.core.last_error={error:"check",plugin:"core",id:"core_08",reason:"Moving node to its current position",data:JSON.stringify({chk:t,pos:s,obj:i&&i.id?i.id:false,par:r&&r.id?r.id:false})};return false}if((!a||!a.is_multi)&&(i.id===r.id||t==="move_node"&&e.inArray(i.id,r.children)===s||e.inArray(r.id,i.children_d)!==-1)){this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:t,pos:s,obj:i&&i.id?i.id:false,par:r&&r.id?r.id:false})};return false}}if(n&&n.data){n=n.data}if(n&&n.functions&&(n.functions[t]===false||n.functions[t]===true)){if(n.functions[t]===false){this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+t,data:JSON.stringify({chk:t,pos:s,obj:i&&i.id?i.id:false,par:r&&r.id?r.id:false})}}return n.functions[t]}if(o===false||e.isFunction(o)&&o.call(this,t,i,r,s,a)===false||o&&o[t]===false){this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+t,data:JSON.stringify({chk:t,pos:s,obj:i&&i.id?i.id:false,par:r&&r.id?r.id:false})};return false}return true},last_error:function(){return this._data.core.last_error},move_node:function(i,r,s,a,n,o,d){var l,h,f,_,u,g,p,m,v,j,k,y,x,b;r=this.get_node(r);s=s===t?0:s;if(!r){return false}if(!s.toString().match(/^(before|after)$/)&&!n&&!this.is_loaded(r)){return this.load_node(r,function(){this.move_node(i,r,s,a,true,false,d)})}if(e.isArray(i)){if(i.length===1){i=i[0]}else{for(l=0,h=i.length;l<h;l++){if(v=this.move_node(i[l],r,s,a,n,false,d)){r=v;s="after"}}this.redraw();return true}}i=i&&i.id?i:this.get_node(i);if(!i||i.id===e.jstree.root){return false}f=(i.parent||e.jstree.root).toString();u=!s.toString().match(/^(before|after)$/)||r.id===e.jstree.root?r:this.get_node(r.parent);g=d?d:this._model.data[i.id]?this:e.jstree.reference(i.id);p=!g||!g._id||this._id!==g._id;_=g&&g._id&&f&&g._model.data[f]&&g._model.data[f].children?e.inArray(i.id,g._model.data[f].children):-1;if(g&&g._id){i=g._model.data[i.id]}if(p){if(v=this.copy_node(i,r,s,a,n,false,d)){if(g){g.delete_node(i)}return v}return false}if(r.id===e.jstree.root){if(s==="before"){s="first"}if(s==="after"){s="last"}}switch(s){case"before":s=e.inArray(r.id,u.children);break;case"after":s=e.inArray(r.id,u.children)+1;break;case"inside":case"first":s=0;break;case"last":s=u.children.length;break;default:if(!s){s=0}break}if(s>u.children.length){s=u.children.length}if(!this.check("move_node",i,u,s,{core:true,origin:d,is_multi:g&&g._id&&g._id!==this._id,is_foreign:!g||!g._id})){this.settings.core.error.call(this,this._data.core.last_error);return false}if(i.parent===u.id){m=u.children.concat();v=e.inArray(i.id,m);if(v!==-1){m=e.vakata.array_remove(m,v);if(s>v){s--}}v=[];for(j=0,k=m.length;j<k;j++){v[j>=s?j+1:j]=m[j]}v[s]=i.id;u.children=v;this._node_changed(u.id);this.redraw(u.id===e.jstree.root)}else{v=i.children_d.concat();v.push(i.id);for(j=0,k=i.parents.length;j<k;j++){m=[];b=g._model.data[i.parents[j]].children_d;for(y=0,x=b.length;y<x;y++){if(e.inArray(b[y],v)===-1){m.push(b[y])}}g._model.data[i.parents[j]].children_d=m}g._model.data[f].children=e.vakata.array_remove_item(g._model.data[f].children,i.id);for(j=0,k=u.parents.length;j<k;j++){this._model.data[u.parents[j]].children_d=this._model.data[u.parents[j]].children_d.concat(v)}m=[];for(j=0,k=u.children.length;j<k;j++){m[j>=s?j+1:j]=u.children[j]}m[s]=i.id;u.children=m;u.children_d.push(i.id);u.children_d=u.children_d.concat(i.children_d);i.parent=u.id;v=u.parents.concat();v.unshift(u.id);b=i.parents.length;i.parents=v;v=v.concat();for(j=0,k=i.children_d.length;j<k;j++){this._model.data[i.children_d[j]].parents=this._model.data[i.children_d[j]].parents.slice(0,b*-1);Array.prototype.push.apply(this._model.data[i.children_d[j]].parents,v)}if(f===e.jstree.root||u.id===e.jstree.root){this._model.force_full_redraw=true}if(!this._model.force_full_redraw){this._node_changed(f);this._node_changed(u.id)}if(!o){this.redraw()}}if(a){a.call(this,i,u,s)}this.trigger("move_node",{node:i,parent:u.id,position:s,old_parent:f,old_position:_,is_multi:g&&g._id&&g._id!==this._id,is_foreign:!g||!g._id,old_instance:g,new_instance:this});return i.id},copy_node:function(i,r,s,a,n,o,d){var l,h,f,_,u,g,p,m,v,j,k;r=this.get_node(r);s=s===t?0:s;if(!r){return false}if(!s.toString().match(/^(before|after)$/)&&!n&&!this.is_loaded(r)){return this.load_node(r,function(){this.copy_node(i,r,s,a,true,false,d)})}if(e.isArray(i)){if(i.length===1){i=i[0]}else{for(l=0,h=i.length;l<h;l++){if(_=this.copy_node(i[l],r,s,a,n,true,d)){r=_;s="after"}}this.redraw();return true}}i=i&&i.id?i:this.get_node(i);if(!i||i.id===e.jstree.root){return false}m=(i.parent||e.jstree.root).toString();v=!s.toString().match(/^(before|after)$/)||r.id===e.jstree.root?r:this.get_node(r.parent);j=d?d:this._model.data[i.id]?this:e.jstree.reference(i.id);k=!j||!j._id||this._id!==j._id;if(j&&j._id){i=j._model.data[i.id]}if(r.id===e.jstree.root){if(s==="before"){s="first"}if(s==="after"){s="last"}}switch(s){case"before":s=e.inArray(r.id,v.children);break;case"after":s=e.inArray(r.id,v.children)+1;break;case"inside":case"first":s=0;break;case"last":s=v.children.length;break;default:if(!s){s=0}break}if(s>v.children.length){s=v.children.length}if(!this.check("copy_node",i,v,s,{core:true,origin:d,is_multi:j&&j._id&&j._id!==this._id,is_foreign:!j||!j._id})){this.settings.core.error.call(this,this._data.core.last_error);return false}p=j?j.get_json(i,{no_id:true,no_data:true,no_state:true}):i;if(!p){return false}if(p.id===true){delete p.id}p=this._parse_model_from_json(p,v.id,v.parents.concat());if(!p){return false}_=this.get_node(p);if(i&&i.state&&i.state.loaded===false){_.state.loaded=false}f=[];f.push(p);f=f.concat(_.children_d);this.trigger("model",{nodes:f,parent:v.id});for(u=0,g=v.parents.length;u<g;u++){this._model.data[v.parents[u]].children_d=this._model.data[v.parents[u]].children_d.concat(f)}f=[];for(u=0,g=v.children.length;u<g;u++){f[u>=s?u+1:u]=v.children[u]}f[s]=_.id;v.children=f;v.children_d.push(_.id);v.children_d=v.children_d.concat(_.children_d);if(v.id===e.jstree.root){this._model.force_full_redraw=true}if(!this._model.force_full_redraw){this._node_changed(v.id)}if(!o){this.redraw(v.id===e.jstree.root)}if(a){a.call(this,_,v,s)}this.trigger("copy_node",{node:_,original:i,parent:v.id,position:s,old_parent:m,old_position:j&&j._id&&m&&j._model.data[m]&&j._model.data[m].children?e.inArray(i.id,j._model.data[m].children):-1,is_multi:j&&j._id&&j._id!==this._id,is_foreign:!j||!j._id,old_instance:j,new_instance:this});return _.id},cut:function(t){if(!t){t=this._data.core.selected.concat()}if(!e.isArray(t)){t=[t]}if(!t.length){return false}var i=[],n,o,d;for(o=0,d=t.length;o<d;o++){n=this.get_node(t[o]);if(n&&n.id&&n.id!==e.jstree.root){i.push(n)}}if(!i.length){return false}r=i;a=this;s="move_node";this.trigger("cut",{node:t})},copy:function(t){if(!t){t=this._data.core.selected.concat()}if(!e.isArray(t)){t=[t]}if(!t.length){return false}var i=[],n,o,d;for(o=0,d=t.length;o<d;o++){n=this.get_node(t[o]);if(n&&n.id&&n.id!==e.jstree.root){i.push(n)}}if(!i.length){return false}r=i;a=this;s="copy_node";this.trigger("copy",{node:t})},get_buffer:function(){return{mode:s,node:r,inst:a}},can_paste:function(){return s!==false&&r!==false},paste:function(e,t){e=this.get_node(e);if(!e||!s||!s.match(/^(copy_node|move_node)$/)||!r){return false}if(this[s](r,e,t,false,false,false,a)){this.trigger("paste",{parent:e.id,node:r,mode:s})}r=false;s=false;a=false},clear_buffer:function(){r=false;s=false;a=false;this.trigger("clear_buffer")},edit:function(t,i,r){var s,a,n,o,l,h,f,_,u,g=false;t=this.get_node(t);if(!t){return false}if(!this.check("edit",t,this.get_parent(t))){this.settings.core.error.call(this,this._data.core.last_error);return false}u=t;i=typeof i==="string"?i:t.text;this.set_text(t,"");t=this._open_to(t);u.text=i;s=this._data.core.rtl;a=this.element.width();this._data.core.focused=u.id;n=t.children(".jstree-anchor").focus();o=e("<span>");l=i;h=e("<"+"div />",{css:{position:"absolute",top:"-200px",left:s?"0px":"-1000px",visibility:"hidden"}}).appendTo(d.body);f=e("<"+"input />",{value:l,class:"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:e.proxy(function(i){i.stopImmediatePropagation();i.preventDefault();var s=o.children(".jstree-rename-input"),a=s.val(),d=this.settings.core.force_text,_;if(a===""){a=l}h.remove();o.replaceWith(n);o.remove();l=d?l:e("<div></div>").append(e.parseHTML(l)).html();t=this.get_node(t);this.set_text(t,l);_=!!this.rename_node(t,d?e("<div></div>").text(a).text():e("<div></div>").append(e.parseHTML(a)).html());if(!_){this.set_text(t,l)}this._data.core.focused=u.id;setTimeout(e.proxy(function(){var e=this.get_node(u.id,true);if(e.length){this._data.core.focused=u.id;e.children(".jstree-anchor").focus()}},this),0);if(r){r.call(this,u,_,g)}f=null},this),keydown:function(e){var t=e.which;if(t===27){g=true;this.value=l}if(t===27||t===13||t===37||t===38||t===39||t===40||t===32){e.stopImmediatePropagation()}if(t===27||t===13){e.preventDefault();this.blur()}},click:function(e){e.stopImmediatePropagation()},mousedown:function(e){e.stopImmediatePropagation()},keyup:function(e){f.width(Math.min(h.text("pW"+this.value).width(),a))},keypress:function(e){if(e.which===13){return false}}});_={fontFamily:n.css("fontFamily")||"",fontSize:n.css("fontSize")||"",fontWeight:n.css("fontWeight")||"",fontStyle:n.css("fontStyle")||"",fontStretch:n.css("fontStretch")||"",fontVariant:n.css("fontVariant")||"",letterSpacing:n.css("letterSpacing")||"",wordSpacing:n.css("wordSpacing")||""};o.attr("class",n.attr("class")).append(n.contents().clone()).append(f);n.replaceWith(o);h.css(_);f.css(_).width(Math.min(h.text("pW"+f[0].value).width(),a))[0].select();e(d).one("mousedown.jstree touchstart.jstree dnd_start.vakata",function(t){if(f&&t.target!==f){e(f).blur()}})},set_theme:function(t,i){if(!t){return false}if(i===true){var r=this.settings.core.themes.dir;if(!r){r=e.jstree.path+"/themes"}i=r+"/"+t+"/style.css"}if(i&&e.inArray(i,n)===-1){e("head").append("<"+'link rel="stylesheet" href="'+i+'" type="text/css" />');n.push(i)}if(this._data.core.themes.name){this.element.removeClass("jstree-"+this._data.core.themes.name)}this._data.core.themes.name=t;this.element.addClass("jstree-"+t);this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+t+"-responsive");this.trigger("set_theme",{theme:t})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(e){if(this._data.core.themes.variant){this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)}this._data.core.themes.variant=e;if(e){this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)}},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=true;this.get_container_ul().addClass("jstree-striped");this.trigger("show_stripes")},hide_stripes:function(){this._data.core.themes.stripes=false;this.get_container_ul().removeClass("jstree-striped");this.trigger("hide_stripes")},toggle_stripes:function(){if(this._data.core.themes.stripes){this.hide_stripes()}else{this.show_stripes()}},show_dots:function(){this._data.core.themes.dots=true;this.get_container_ul().removeClass("jstree-no-dots");this.trigger("show_dots")},hide_dots:function(){this._data.core.themes.dots=false;this.get_container_ul().addClass("jstree-no-dots");this.trigger("hide_dots")},toggle_dots:function(){if(this._data.core.themes.dots){this.hide_dots()}else{this.show_dots()}},show_icons:function(){this._data.core.themes.icons=true;this.get_container_ul().removeClass("jstree-no-icons");this.trigger("show_icons")},hide_icons:function(){this._data.core.themes.icons=false;this.get_container_ul().addClass("jstree-no-icons");this.trigger("hide_icons")},toggle_icons:function(){if(this._data.core.themes.icons){this.hide_icons()}else{this.show_icons()}},show_ellipsis:function(){this._data.core.themes.ellipsis=true;this.get_container_ul().addClass("jstree-ellipsis");this.trigger("show_ellipsis")},hide_ellipsis:function(){this._data.core.themes.ellipsis=false;this.get_container_ul().removeClass("jstree-ellipsis");this.trigger("hide_ellipsis")},toggle_ellipsis:function(){if(this._data.core.themes.ellipsis){this.hide_ellipsis()}else{this.show_ellipsis()}},set_icon:function(i,r){var s,a,n,o;if(e.isArray(i)){i=i.slice();for(s=0,a=i.length;s<a;s++){this.set_icon(i[s],r)}return true}i=this.get_node(i);if(!i||i.id===e.jstree.root){return false}o=i.icon;i.icon=r===true||r===null||r===t||r===""?true:r;n=this.get_node(i,true).children(".jstree-anchor").children(".jstree-themeicon");if(r===false){n.removeClass("jstree-themeicon-custom "+o).css("background","").removeAttr("rel");this.hide_icon(i)}else if(r===true||r===null||r===t||r===""){n.removeClass("jstree-themeicon-custom "+o).css("background","").removeAttr("rel");if(o===false){this.show_icon(i)}}else if(r.indexOf("/")===-1&&r.indexOf(".")===-1){n.removeClass(o).css("background","");n.addClass(r+" jstree-themeicon-custom").attr("rel",r);if(o===false){this.show_icon(i)}}else{n.removeClass(o).css("background","");n.addClass("jstree-themeicon-custom").css("background","url('"+r+"') center center no-repeat").attr("rel",r);if(o===false){this.show_icon(i)}}return true},get_icon:function(t){t=this.get_node(t);return!t||t.id===e.jstree.root?false:t.icon},hide_icon:function(t){var i,r;if(e.isArray(t)){t=t.slice();for(i=0,r=t.length;i<r;i++){this.hide_icon(t[i])}return true}t=this.get_node(t);if(!t||t===e.jstree.root){return false}t.icon=false;this.get_node(t,true).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden");return true},show_icon:function(t){var i,r,s;if(e.isArray(t)){t=t.slice();for(i=0,r=t.length;i<r;i++){this.show_icon(t[i])}return true}t=this.get_node(t);if(!t||t===e.jstree.root){return false}s=this.get_node(t,true);t.icon=s.length?s.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"):true;if(!t.icon){t.icon=true}s.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden");return true}};e.vakata={};e.vakata.attributes=function(t,i){t=e(t)[0];var r=i?{}:[];if(t&&t.attributes){e.each(t.attributes,function(t,s){if(e.inArray(s.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])!==-1){return}if(s.value!==null&&e.trim(s.value)!==""){if(i){r[s.name]=s.value}else{r.push(s.name)}}})}return r};e.vakata.array_unique=function(e){var i=[],r,s,a,n={};for(r=0,a=e.length;r<a;r++){if(n[e[r]]===t){i.push(e[r]);n[e[r]]=true}}return i};e.vakata.array_remove=function(e,t){e.splice(t,1);return e};e.vakata.array_remove_item=function(t,i){var r=e.inArray(i,t);return r!==-1?e.vakata.array_remove(t,r):t};e.vakata.array_filter=function(e,t,i,r,s){if(e.filter){return e.filter(t,i)}r=[];for(s in e){if(~~s+""===s+""&&s>=0&&t.call(i,e[s],+s,e)){r.push(e[s])}}return r};e.jstree.plugins.changed=function(e,t){var i=[];this.trigger=function(e,r){var s,a;if(!r){r={}}if(e.replace(".jstree","")==="changed"){r.changed={selected:[],deselected:[]};var n={};for(s=0,a=i.length;s<a;s++){n[i[s]]=1}for(s=0,a=r.selected.length;s<a;s++){if(!n[r.selected[s]]){r.changed.selected.push(r.selected[s])}else{n[r.selected[s]]=2}}for(s=0,a=i.length;s<a;s++){if(n[i[s]]===1){r.changed.deselected.push(i[s])}}i=r.selected.slice()}t.trigger.call(this,e,r)};this.refresh=function(e,r){i=[];return t.refresh.apply(this,arguments)}};var f=d.createElement("I");f.className="jstree-icon jstree-checkbox";f.setAttribute("role","presentation");e.jstree.defaults.checkbox={visible:true,three_state:true,whole_node:true,keep_selected_style:true,cascade:"",tie_selection:true,cascade_to_disabled:true,cascade_to_hidden:true};e.jstree.plugins.checkbox=function(i,r){this.bind=function(){r.bind.call(this);this._data.checkbox.uto=false;this._data.checkbox.selected=[];if(this.settings.checkbox.three_state){this.settings.checkbox.cascade="up+down+undetermined"}this.element.on("init.jstree",e.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible;if(!this.settings.checkbox.keep_selected_style){this.element.addClass("jstree-checkbox-no-clicked")}if(this.settings.checkbox.tie_selection){this.element.addClass("jstree-checkbox-selection")}},this)).on("loading.jstree",e.proxy(function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()},this));if(this.settings.checkbox.cascade.indexOf("undetermined")!==-1){this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",e.proxy(function(){if(this._data.checkbox.uto){clearTimeout(this._data.checkbox.uto)}this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)},this))}if(!this.settings.checkbox.tie_selection){this.element.on("model.jstree",e.proxy(function(e,t){var i=this._model.data,r=i[t.parent],s=t.nodes,a,n;for(a=0,n=s.length;a<n;a++){i[s[a]].state.checked=i[s[a]].state.checked||i[s[a]].original&&i[s[a]].original.state&&i[s[a]].original.state.checked;if(i[s[a]].state.checked){this._data.checkbox.selected.push(s[a])}}},this))}if(this.settings.checkbox.cascade.indexOf("up")!==-1||this.settings.checkbox.cascade.indexOf("down")!==-1){this.element.on("model.jstree",e.proxy(function(t,i){var r=this._model.data,s=r[i.parent],a=i.nodes,n=[],o,d,l,h,f,_,u=this.settings.checkbox.cascade,g=this.settings.checkbox.tie_selection;if(u.indexOf("down")!==-1){if(s.state[g?"selected":"checked"]){for(d=0,l=a.length;d<l;d++){r[a[d]].state[g?"selected":"checked"]=true}this._data[g?"core":"checkbox"].selected=this._data[g?"core":"checkbox"].selected.concat(a)}else{for(d=0,l=a.length;d<l;d++){if(r[a[d]].state[g?"selected":"checked"]){for(h=0,f=r[a[d]].children_d.length;h<f;h++){r[r[a[d]].children_d[h]].state[g?"selected":"checked"]=true}this._data[g?"core":"checkbox"].selected=this._data[g?"core":"checkbox"].selected.concat(r[a[d]].children_d)}}}}if(u.indexOf("up")!==-1){for(d=0,l=s.children_d.length;d<l;d++){if(!r[s.children_d[d]].children.length){n.push(r[s.children_d[d]].parent)}}n=e.vakata.array_unique(n);for(h=0,f=n.length;h<f;h++){s=r[n[h]];while(s&&s.id!==e.jstree.root){o=0;for(d=0,l=s.children.length;d<l;d++){o+=r[s.children[d]].state[g?"selected":"checked"]}if(o===l){s.state[g?"selected":"checked"]=true;this._data[g?"core":"checkbox"].selected.push(s.id);_=this.get_node(s,true);if(_&&_.length){_.attr("aria-selected",true).children(".jstree-anchor").addClass(g?"jstree-clicked":"jstree-checked")}}else{break}s=this.get_node(s.parent)}}}this._data[g?"core":"checkbox"].selected=e.vakata.array_unique(this._data[g?"core":"checkbox"].selected)},this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",e.proxy(function(t,i){var r=this,s=i.node,a=this._model.data,n=this.get_node(s.parent),o,d,l,h,f=this.settings.checkbox.cascade,_=this.settings.checkbox.tie_selection,u={},g=this._data[_?"core":"checkbox"].selected;for(o=0,d=g.length;o<d;o++){u[g[o]]=true}if(f.indexOf("down")!==-1){var p=this._cascade_new_checked_state(s.id,true);var m=s.children_d.concat(s.id);for(o=0,d=m.length;o<d;o++){if(p.indexOf(m[o])>-1){u[m[o]]=true}else{delete u[m[o]]}}}if(f.indexOf("up")!==-1){while(n&&n.id!==e.jstree.root){l=0;for(o=0,d=n.children.length;o<d;o++){l+=a[n.children[o]].state[_?"selected":"checked"]}if(l===d){n.state[_?"selected":"checked"]=true;u[n.id]=true;h=this.get_node(n,true);if(h&&h.length){h.attr("aria-selected",true).children(".jstree-anchor").addClass(_?"jstree-clicked":"jstree-checked")}}else{break}n=this.get_node(n.parent)}}g=[];for(o in u){if(u.hasOwnProperty(o)){g.push(o)}}this._data[_?"core":"checkbox"].selected=g},this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",e.proxy(function(t,i){var r=this.get_node(e.jstree.root),s=this._model.data,a,n,o;for(a=0,n=r.children_d.length;a<n;a++){o=s[r.children_d[a]];if(o&&o.original&&o.original.state&&o.original.state.undetermined){o.original.state.undetermined=false}}},this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",e.proxy(function(t,i){var r=this,s=i.node,a=this.get_node(s,true),n,o,d,l=this.settings.checkbox.cascade,h=this.settings.checkbox.tie_selection,f=this._data[h?"core":"checkbox"].selected,_={},u=[],g=s.children_d.concat(s.id);if(l.indexOf("down")!==-1){var p=this._cascade_new_checked_state(s.id,false);f=e.vakata.array_filter(f,function(e){return g.indexOf(e)===-1||p.indexOf(e)>-1})}if(l.indexOf("up")!==-1&&f.indexOf(s.id)===-1){for(n=0,o=s.parents.length;n<o;n++){d=this._model.data[s.parents[n]];d.state[h?"selected":"checked"]=false;if(d&&d.original&&d.original.state&&d.original.state.undetermined){d.original.state.undetermined=false}d=this.get_node(s.parents[n],true);if(d&&d.length){d.attr("aria-selected",false).children(".jstree-anchor").removeClass(h?"jstree-clicked":"jstree-checked")}}f=e.vakata.array_filter(f,function(e){return s.parents.indexOf(e)===-1})}this._data[h?"core":"checkbox"].selected=f},this))}if(this.settings.checkbox.cascade.indexOf("up")!==-1){this.element.on("delete_node.jstree",e.proxy(function(t,i){var r=this.get_node(i.parent),s=this._model.data,a,n,o,d,l=this.settings.checkbox.tie_selection;while(r&&r.id!==e.jstree.root&&!r.state[l?"selected":"checked"]){o=0;for(a=0,n=r.children.length;a<n;a++){o+=s[r.children[a]].state[l?"selected":"checked"]}if(n>0&&o===n){r.state[l?"selected":"checked"]=true;this._data[l?"core":"checkbox"].selected.push(r.id);d=this.get_node(r,true);if(d&&d.length){d.attr("aria-selected",true).children(".jstree-anchor").addClass(l?"jstree-clicked":"jstree-checked")}}else{break}r=this.get_node(r.parent)}},this)).on("move_node.jstree",e.proxy(function(t,i){var r=i.is_multi,s=i.old_parent,a=this.get_node(i.parent),n=this._model.data,o,d,l,h,f,_=this.settings.checkbox.tie_selection;if(!r){o=this.get_node(s);while(o&&o.id!==e.jstree.root&&!o.state[_?"selected":"checked"]){d=0;for(l=0,h=o.children.length;l<h;l++){d+=n[o.children[l]].state[_?"selected":"checked"]}if(h>0&&d===h){o.state[_?"selected":"checked"]=true;this._data[_?"core":"checkbox"].selected.push(o.id);f=this.get_node(o,true);if(f&&f.length){f.attr("aria-selected",true).children(".jstree-anchor").addClass(_?"jstree-clicked":"jstree-checked")}}else{break}o=this.get_node(o.parent)}}o=a;while(o&&o.id!==e.jstree.root){d=0;for(l=0,h=o.children.length;l<h;l++){d+=n[o.children[l]].state[_?"selected":"checked"]}if(d===h){if(!o.state[_?"selected":"checked"]){o.state[_?"selected":"checked"]=true;this._data[_?"core":"checkbox"].selected.push(o.id);f=this.get_node(o,true);if(f&&f.length){f.attr("aria-selected",true).children(".jstree-anchor").addClass(_?"jstree-clicked":"jstree-checked")}}}else{if(o.state[_?"selected":"checked"]){o.state[_?"selected":"checked"]=false;this._data[_?"core":"checkbox"].selected=e.vakata.array_remove_item(this._data[_?"core":"checkbox"].selected,o.id);f=this.get_node(o,true);if(f&&f.length){f.attr("aria-selected",false).children(".jstree-anchor").removeClass(_?"jstree-clicked":"jstree-checked")}}else{break}}o=this.get_node(o.parent)}},this))}};this.get_undetermined=function(i){if(this.settings.checkbox.cascade.indexOf("undetermined")===-1){return[]}var r,s,a,n,o={},d=this._model.data,l=this.settings.checkbox.tie_selection,h=this._data[l?"core":"checkbox"].selected,f=[],_=this,u=[];for(r=0,s=h.length;r<s;r++){if(d[h[r]]&&d[h[r]].parents){for(a=0,n=d[h[r]].parents.length;a<n;a++){if(o[d[h[r]].parents[a]]!==t){break}if(d[h[r]].parents[a]!==e.jstree.root){o[d[h[r]].parents[a]]=true;f.push(d[h[r]].parents[a])}}}}this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var i=_.get_node(this),l;if(!i){return}if(!i.state.loaded){if(i.original&&i.original.state&&i.original.state.undetermined&&i.original.state.undetermined===true){if(o[i.id]===t&&i.id!==e.jstree.root){o[i.id]=true;f.push(i.id)}for(a=0,n=i.parents.length;a<n;a++){if(o[i.parents[a]]===t&&i.parents[a]!==e.jstree.root){o[i.parents[a]]=true;f.push(i.parents[a])}}}}else{for(r=0,s=i.children_d.length;r<s;r++){l=d[i.children_d[r]];if(!l.state.loaded&&l.original&&l.original.state&&l.original.state.undetermined&&l.original.state.undetermined===true){if(o[l.id]===t&&l.id!==e.jstree.root){o[l.id]=true;f.push(l.id)}for(a=0,n=l.parents.length;a<n;a++){if(o[l.parents[a]]===t&&l.parents[a]!==e.jstree.root){o[l.parents[a]]=true;f.push(l.parents[a])}}}}}});for(r=0,s=f.length;r<s;r++){if(!d[f[r]].state[l?"selected":"checked"]){u.push(i?d[f[r]]:f[r])}}return u};this._undetermined=function(){if(this.element===null){return}var e=this.get_undetermined(false),t,i,r;this.element.find(".jstree-undetermined").removeClass("jstree-undetermined");for(t=0,i=e.length;t<i;t++){r=this.get_node(e[t],true);if(r&&r.length){r.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined")}}};this.redraw_node=function(t,i,s,a){t=r.redraw_node.apply(this,arguments);if(t){var n,o,d=null,l=null;for(n=0,o=t.childNodes.length;n<o;n++){if(t.childNodes[n]&&t.childNodes[n].className&&t.childNodes[n].className.indexOf("jstree-anchor")!==-1){d=t.childNodes[n];break}}if(d){if(!this.settings.checkbox.tie_selection&&this._model.data[t.id].state.checked){d.className+=" jstree-checked"}l=f.cloneNode(false);if(this._model.data[t.id].state.checkbox_disabled){l.className+=" jstree-checkbox-disabled"}d.insertBefore(l,d.childNodes[0])}}if(!s&&this.settings.checkbox.cascade.indexOf("undetermined")!==-1){if(this._data.checkbox.uto){clearTimeout(this._data.checkbox.uto)}this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)}return t};this.show_checkboxes=function(){this._data.core.themes.checkboxes=true;this.get_container_ul().removeClass("jstree-no-checkboxes")};this.hide_checkboxes=function(){this._data.core.themes.checkboxes=false;this.get_container_ul().addClass("jstree-no-checkboxes")};this.toggle_checkboxes=function(){if(this._data.core.themes.checkboxes){this.hide_checkboxes()}else{this.show_checkboxes()}};this.is_undetermined=function(t){t=this.get_node(t);var i=this.settings.checkbox.cascade,r,s,a=this.settings.checkbox.tie_selection,n=this._data[a?"core":"checkbox"].selected,o=this._model.data;if(!t||t.state[a?"selected":"checked"]===true||i.indexOf("undetermined")===-1||i.indexOf("down")===-1&&i.indexOf("up")===-1){return false}if(!t.state.loaded&&t.original.state.undetermined===true){return true}for(r=0,s=t.children_d.length;r<s;r++){if(e.inArray(t.children_d[r],n)!==-1||!o[t.children_d[r]].state.loaded&&o[t.children_d[r]].original.state.undetermined){return true}}return false};this.disable_checkbox=function(t){var i,r,s;if(e.isArray(t)){t=t.slice();for(i=0,r=t.length;i<r;i++){this.disable_checkbox(t[i])}return true}t=this.get_node(t);if(!t||t.id===e.jstree.root){return false}s=this.get_node(t,true);if(!t.state.checkbox_disabled){t.state.checkbox_disabled=true;if(s&&s.length){s.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-checkbox-disabled")}this.trigger("disable_checkbox",{node:t})}};this.enable_checkbox=function(t){var i,r,s;if(e.isArray(t)){t=t.slice();for(i=0,r=t.length;i<r;i++){this.enable_checkbox(t[i])}return true}t=this.get_node(t);if(!t||t.id===e.jstree.root){return false}s=this.get_node(t,true);if(t.state.checkbox_disabled){t.state.checkbox_disabled=false;if(s&&s.length){s.children(".jstree-anchor").children(".jstree-checkbox").removeClass("jstree-checkbox-disabled")}this.trigger("enable_checkbox",{node:t})}};this.activate_node=function(t,i){if(e(i.target).hasClass("jstree-checkbox-disabled")){return false}if(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||e(i.target).hasClass("jstree-checkbox"))){i.ctrlKey=true}if(this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!e(i.target).hasClass("jstree-checkbox")){return r.activate_node.call(this,t,i)}if(this.is_disabled(t)){return false}if(this.is_checked(t)){this.uncheck_node(t,i)}else{this.check_node(t,i)}this.trigger("activate_node",{node:this.get_node(t)})};this._cascade_new_checked_state=function(e,t){var i=this;var r=this.settings.checkbox.tie_selection;var s=this._model.data[e];var a=[];var n=[],o,d,l;if((this.settings.checkbox.cascade_to_disabled||!s.state.disabled)&&(this.settings.checkbox.cascade_to_hidden||!s.state.hidden)){if(s.children){for(o=0,d=s.children.length;o<d;o++){var h=s.children[o];l=i._cascade_new_checked_state(h,t);a=a.concat(l);if(l.indexOf(h)>-1){n.push(h)}}}var f=i.get_node(s,true);var _=n.length>0&&n.length<s.children.length;if(s.original&&s.original.state&&s.original.state.undetermined){s.original.state.undetermined=_}if(_){s.state[r?"selected":"checked"]=false;f.attr("aria-selected",false).children(".jstree-anchor").removeClass(r?"jstree-clicked":"jstree-checked")}else if(t&&n.length===s.children.length){s.state[r?"selected":"checked"]=t;a.push(s.id);f.attr("aria-selected",true).children(".jstree-anchor").addClass(r?"jstree-clicked":"jstree-checked")}else{s.state[r?"selected":"checked"]=false;f.attr("aria-selected",false).children(".jstree-anchor").removeClass(r?"jstree-clicked":"jstree-checked")}}else{l=this.get_checked_descendants(e);if(s.state[r?"selected":"checked"]){l.push(s.id)}a=a.concat(l)}return a};this.get_checked_descendants=function(t){var i=this;var r=i.settings.checkbox.tie_selection;var s=i._model.data[t];return e.vakata.array_filter(s.children_d,function(e){return i._model.data[e].state[r?"selected":"checked"]})};this.check_node=function(t,i){if(this.settings.checkbox.tie_selection){return this.select_node(t,false,true,i)}var r,s,a,n;if(e.isArray(t)){t=t.slice();for(s=0,a=t.length;s<a;s++){this.check_node(t[s],i)}return true}t=this.get_node(t);if(!t||t.id===e.jstree.root){return false}r=this.get_node(t,true);if(!t.state.checked){t.state.checked=true;this._data.checkbox.selected.push(t.id);if(r&&r.length){r.children(".jstree-anchor").addClass("jstree-checked")}this.trigger("check_node",{node:t,selected:this._data.checkbox.selected,event:i})}};this.uncheck_node=function(t,i){if(this.settings.checkbox.tie_selection){return this.deselect_node(t,false,i)}var r,s,a;if(e.isArray(t)){t=t.slice();for(r=0,s=t.length;r<s;r++){this.uncheck_node(t[r],i)}return true}t=this.get_node(t);if(!t||t.id===e.jstree.root){return false}a=this.get_node(t,true);if(t.state.checked){t.state.checked=false;this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,t.id);if(a.length){a.children(".jstree-anchor").removeClass("jstree-checked")}this.trigger("uncheck_node",{node:t,selected:this._data.checkbox.selected,event:i})}};this.check_all=function(){if(this.settings.checkbox.tie_selection){return this.select_all()}var t=this._data.checkbox.selected.concat([]),i,r;this._data.checkbox.selected=this._model.data[e.jstree.root].children_d.concat();for(i=0,r=this._data.checkbox.selected.length;i<r;i++){if(this._model.data[this._data.checkbox.selected[i]]){this._model.data[this._data.checkbox.selected[i]].state.checked=true}}this.redraw(true);this.trigger("check_all",{selected:this._data.checkbox.selected})};this.uncheck_all=function(){if(this.settings.checkbox.tie_selection){return this.deselect_all()}var e=this._data.checkbox.selected.concat([]),t,i;for(t=0,i=this._data.checkbox.selected.length;t<i;t++){if(this._model.data[this._data.checkbox.selected[t]]){this._model.data[this._data.checkbox.selected[t]].state.checked=false}}this._data.checkbox.selected=[];this.element.find(".jstree-checked").removeClass("jstree-checked");this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:e})};this.is_checked=function(t){if(this.settings.checkbox.tie_selection){return this.is_selected(t)}t=this.get_node(t);if(!t||t.id===e.jstree.root){return false}return t.state.checked};this.get_checked=function(t){if(this.settings.checkbox.tie_selection){return this.get_selected(t)}return t?e.map(this._data.checkbox.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.checkbox.selected.slice()};this.get_top_checked=function(t){if(this.settings.checkbox.tie_selection){return this.get_top_selected(t)}var i=this.get_checked(true),r={},s,a,n,o;for(s=0,a=i.length;s<a;s++){r[i[s].id]=i[s]}for(s=0,a=i.length;s<a;s++){for(n=0,o=i[s].children_d.length;n<o;n++){if(r[i[s].children_d[n]]){delete r[i[s].children_d[n]]}}}i=[];for(s in r){if(r.hasOwnProperty(s)){i.push(s)}}return t?e.map(i,e.proxy(function(e){return this.get_node(e)},this)):i};this.get_bottom_checked=function(t){if(this.settings.checkbox.tie_selection){return this.get_bottom_selected(t)}var i=this.get_checked(true),r=[],s,a;for(s=0,a=i.length;s<a;s++){if(!i[s].children.length){r.push(i[s].id)}}return t?e.map(r,e.proxy(function(e){return this.get_node(e)},this)):r};this.load_node=function(t,i){var s,a,n,o,d,l;if(!e.isArray(t)&&!this.settings.checkbox.tie_selection){l=this.get_node(t);if(l&&l.state.loaded){for(s=0,a=l.children_d.length;s<a;s++){if(this._model.data[l.children_d[s]].state.checked){d=true;this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,l.children_d[s])}}}}return r.load_node.apply(this,arguments)};this.get_state=function(){var e=r.get_state.apply(this,arguments);if(this.settings.checkbox.tie_selection){return e}e.checkbox=this._data.checkbox.selected.slice();return e};this.set_state=function(t,i){var s=r.set_state.apply(this,arguments);if(s&&t.checkbox){if(!this.settings.checkbox.tie_selection){this.uncheck_all();var a=this;e.each(t.checkbox,function(e,t){a.check_node(t)})}delete t.checkbox;this.set_state(t,i);return false}return s};this.refresh=function(e,t){if(this.settings.checkbox.tie_selection){this._data.checkbox.selected=[]}return r.refresh.apply(this,arguments)}};e.jstree.defaults.conditionalselect=function(){return true};e.jstree.plugins.conditionalselect=function(e,t){this.activate_node=function(e,i){if(this.settings.conditionalselect.call(this,this.get_node(e),i)){return t.activate_node.call(this,e,i)}}};e.jstree.defaults.contextmenu={select_node:true,show_at_node:true,items:function(t,i){return{create:{separator_before:false,separator_after:true,_disabled:false,label:"Create",action:function(t){var i=e.jstree.reference(t.reference),r=i.get_node(t.reference);i.create_node(r,{},"last",function(e){try{i.edit(e)}catch(t){setTimeout(function(){i.edit(e)},0)}})}},rename:{separator_before:false,separator_after:false,_disabled:false,label:"Rename",action:function(t){var i=e.jstree.reference(t.reference),r=i.get_node(t.reference);i.edit(r)}},remove:{separator_before:false,icon:false,separator_after:false,_disabled:false,label:"Delete",action:function(t){var i=e.jstree.reference(t.reference),r=i.get_node(t.reference);if(i.is_selected(r)){i.delete_node(i.get_selected())}else{i.delete_node(r)}}},ccp:{separator_before:true,icon:false,separator_after:false,label:"Edit",action:false,submenu:{cut:{separator_before:false,separator_after:false,label:"Cut",action:function(t){var i=e.jstree.reference(t.reference),r=i.get_node(t.reference);if(i.is_selected(r)){i.cut(i.get_top_selected())}else{i.cut(r)}}},copy:{separator_before:false,icon:false,separator_after:false,label:"Copy",action:function(t){var i=e.jstree.reference(t.reference),r=i.get_node(t.reference);if(i.is_selected(r)){i.copy(i.get_top_selected())}else{i.copy(r)}}},paste:{separator_before:false,icon:false,_disabled:function(t){return!e.jstree.reference(t.reference).can_paste()},separator_after:false,label:"Paste",action:function(t){var i=e.jstree.reference(t.reference),r=i.get_node(t.reference);i.paste(r)}}}}}}};e.jstree.plugins.contextmenu=function(i,r){this.bind=function(){r.bind.call(this);var t=0,i=null,s,a;this.element.on("init.jstree loading.jstree ready.jstree",e.proxy(function(){this.get_container_ul().addClass("jstree-contextmenu")},this)).on("contextmenu.jstree",".jstree-anchor",e.proxy(function(e,r){if(e.target.tagName.toLowerCase()==="input"){return}e.preventDefault();t=e.ctrlKey?+new Date:0;if(r||i){t=+new Date+1e4}if(i){clearTimeout(i)}if(!this.is_loading(e.currentTarget)){this.show_contextmenu(e.currentTarget,e.pageX,e.pageY,e)}},this)).on("click.jstree",".jstree-anchor",e.proxy(function(i){if(this._data.contextmenu.visible&&(!t||+new Date-t>250)){e.vakata.context.hide()}t=0},this)).on("touchstart.jstree",".jstree-anchor",function(t){if(!t.originalEvent||!t.originalEvent.changedTouches||!t.originalEvent.changedTouches[0]){return}s=t.originalEvent.changedTouches[0].clientX;a=t.originalEvent.changedTouches[0].clientY;i=setTimeout(function(){e(t.currentTarget).trigger("contextmenu",true)},750)}).on("touchmove.vakata.jstree",function(t){if(i&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(Math.abs(s-t.originalEvent.changedTouches[0].clientX)>10||Math.abs(a-t.originalEvent.changedTouches[0].clientY)>10)){clearTimeout(i);e.vakata.context.hide()}}).on("touchend.vakata.jstree",function(e){if(i){clearTimeout(i)}});e(d).on("context_hide.vakata.jstree",e.proxy(function(t,i){this._data.contextmenu.visible=false;e(i.reference).removeClass("jstree-context")},this))};this.teardown=function(){if(this._data.contextmenu.visible){e.vakata.context.hide()}r.teardown.call(this)};this.show_contextmenu=function(i,r,s,a){i=this.get_node(i);if(!i||i.id===e.jstree.root){return false}var n=this.settings.contextmenu,o=this.get_node(i,true),d=o.children(".jstree-anchor"),l=false,h=false;if(n.show_at_node||r===t||s===t){l=d.offset();r=l.left;s=l.top+this._data.core.li_height}if(this.settings.contextmenu.select_node&&!this.is_selected(i)){this.activate_node(i,a)}h=n.items;if(e.isFunction(h)){h=h.call(this,i,e.proxy(function(e){this._show_contextmenu(i,r,s,e)},this))}if(e.isPlainObject(h)){this._show_contextmenu(i,r,s,h)}};this._show_contextmenu=function(t,i,r,s){var a=this.get_node(t,true),n=a.children(".jstree-anchor");e(d).one("context_show.vakata.jstree",e.proxy(function(t,i){var r="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";e(i.element).addClass(r);n.addClass("jstree-context")},this));this._data.contextmenu.visible=true;e.vakata.context.show(n,{x:i,y:r},s);this.trigger("show_contextmenu",{node:t,x:i,y:r})}};(function(e){var t=false,i={element:false,reference:false,position_x:0,position_y:0,items:[],html:"",is_visible:false};e.vakata.context={settings:{hide_onmouseleave:0,icons:true},_trigger:function(t){e(d).triggerHandler("context_"+t+".vakata",{reference:i.reference,element:i.element,position:{x:i.position_x,y:i.position_y}})},_execute:function(t){t=i.items[t];return t&&(!t._disabled||e.isFunction(t._disabled)&&!t._disabled({item:t,reference:i.reference,element:i.element}))&&t.action?t.action.call(null,{item:t,reference:i.reference,element:i.element,position:{x:i.position_x,y:i.position_y}}):false},_parse:function(t,r){if(!t){return false}if(!r){i.html="";i.items=[]}var s="",a=false,n;if(r){s+="<"+"ul>"}e.each(t,function(t,r){if(!r){return true}i.items.push(r);if(!a&&r.separator_before){s+="<"+"li class='vakata-context-separator'><"+"a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;<"+"/a><"+"/li>"}a=false;s+="<"+"li class='"+(r._class||"")+(r._disabled===true||e.isFunction(r._disabled)&&r._disabled({item:r,reference:i.reference,element:i.element})?" vakata-contextmenu-disabled ":"")+"' "+(r.shortcut?" data-shortcut='"+r.shortcut+"' ":"")+">";s+="<"+"a href='#' rel='"+(i.items.length-1)+"' "+(r.title?"title='"+r.title+"'":"")+">";if(e.vakata.context.settings.icons){s+="<"+"i ";if(r.icon){if(r.icon.indexOf("/")!==-1||r.icon.indexOf(".")!==-1){s+=" style='background:url(\""+r.icon+"\") center center no-repeat' "}else{s+=" class='"+r.icon+"' "}}s+="><"+"/i><"+"span class='vakata-contextmenu-sep'>&#160;<"+"/span>"}s+=(e.isFunction(r.label)?r.label({item:t,reference:i.reference,element:i.element}):r.label)+(r.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+r.shortcut+'">'+(r.shortcut_label||"")+"</span>":"")+"<"+"/a>";if(r.submenu){n=e.vakata.context._parse(r.submenu,true);if(n){s+=n}}s+="<"+"/li>";if(r.separator_after){s+="<"+"li class='vakata-context-separator'><"+"a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;<"+"/a><"+"/li>";a=true}});s=s.replace(/<li class\='vakata-context-separator'\><\/li\>$/,"");if(r){s+="</ul>"}if(!r){i.html=s;e.vakata.context._trigger("parse")}return s.length>10?s:false},_show_submenu:function(i){i=e(i);if(!i.length||!i.children("ul").length){return}var r=i.children("ul"),s=i.offset().left,a=s+i.outerWidth(),n=i.offset().top,o=r.width(),d=r.height(),l=e(window).width()+e(window).scrollLeft(),h=e(window).height()+e(window).scrollTop();if(t){i[a-(o+10+i.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left")}else{i[a+o>l&&s>l-a?"addClass":"removeClass"]("vakata-context-right")}if(n+d+10>h){r.css("bottom","-1px")}if(i.hasClass("vakata-context-right")){if(s<o){r.css("margin-right",s-o)}}else{if(l-a<o){r.css("margin-left",l-a-o)}}r.show()},show:function(r,s,a){var n,o,l,h,f,_,u,g,p=true;if(i.element&&i.element.length){i.element.width("")}switch(p){case!s&&!r:return false;case!!s&&!!r:i.reference=r;i.position_x=s.x;i.position_y=s.y;break;case!s&&!!r:i.reference=r;n=r.offset();i.position_x=n.left+r.outerHeight();i.position_y=n.top;break;case!!s&&!r:i.position_x=s.x;i.position_y=s.y;break}if(!!r&&!a&&e(r).data("vakata_contextmenu")){a=e(r).data("vakata_contextmenu")}if(e.vakata.context._parse(a)){i.element.html(i.html)}if(i.items.length){i.element.appendTo(d.body);o=i.element;l=i.position_x;h=i.position_y;f=o.width();_=o.height();u=e(window).width()+e(window).scrollLeft();g=e(window).height()+e(window).scrollTop();if(t){l-=o.outerWidth()-e(r).outerWidth();if(l<e(window).scrollLeft()+20){l=e(window).scrollLeft()+20}}if(l+f+20>u){l=u-(f+20)}if(h+_+20>g){h=g-(_+20)}i.element.css({left:l,top:h}).show().find("a").first().focus().parent().addClass("vakata-context-hover");i.is_visible=true;e.vakata.context._trigger("show")}},hide:function(){if(i.is_visible){i.element.hide().find("ul").hide().end().find(":focus").blur().end().detach();i.is_visible=false;e.vakata.context._trigger("hide")}}};e(function(){t=e(d.body).css("direction")==="rtl";var r=false;i.element=e("<ul class='vakata-context'></ul>");i.element.on("mouseenter","li",function(t){t.stopImmediatePropagation();if(e.contains(this,t.relatedTarget)){return}if(r){clearTimeout(r)}i.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end();e(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover");e.vakata.context._show_submenu(this)}).on("mouseleave","li",function(t){if(e.contains(this,t.relatedTarget)){return}e(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(t){e(this).find(".vakata-context-hover").removeClass("vakata-context-hover");if(e.vakata.context.settings.hide_onmouseleave){r=setTimeout(function(t){return function(){e.vakata.context.hide()}}(this),e.vakata.context.settings.hide_onmouseleave)}}).on("click","a",function(t){t.preventDefault();if(!e(this).blur().parent().hasClass("vakata-context-disabled")&&e.vakata.context._execute(e(this).attr("rel"))!==false){e.vakata.context.hide()}}).on("keydown","a",function(t){var r=null;switch(t.which){case 13:case 32:t.type="click";t.preventDefault();e(t.currentTarget).trigger(t);break;case 37:if(i.is_visible){i.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus();t.stopImmediatePropagation();t.preventDefault()}break;case 38:if(i.is_visible){r=i.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first();if(!r.length){r=i.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()}r.addClass("vakata-context-hover").children("a").focus();t.stopImmediatePropagation();t.preventDefault()}break;case 39:if(i.is_visible){i.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus();t.stopImmediatePropagation();t.preventDefault()}break;case 40:if(i.is_visible){r=i.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first();if(!r.length){r=i.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()}r.addClass("vakata-context-hover").children("a").focus();t.stopImmediatePropagation();t.preventDefault()}break;case 27:e.vakata.context.hide();t.preventDefault();break;default:break}}).on("keydown",function(e){e.preventDefault();var t=i.element.find(".vakata-contextmenu-shortcut-"+e.which).parent();if(t.parent().not(".vakata-context-disabled")){t.click()}});e(d).on("mousedown.vakata.jstree",function(t){if(i.is_visible&&i.element[0]!==t.target&&!e.contains(i.element[0],t.target)){e.vakata.context.hide()}}).on("context_show.vakata.jstree",function(e,r){i.element.find("li:has(ul)").children("a").addClass("vakata-context-parent");if(t){i.element.addClass("vakata-context-rtl").css("direction","rtl")}i.element.find("ul").hide().end()})})})(e);e.jstree.defaults.dnd={copy:true,open_timeout:500,is_draggable:true,check_while_dragging:true,always_copy:false,inside_pos:0,drag_selection:true,touch:true,large_drop_target:false,large_drag_target:false,use_html5:false};var _,u;e.jstree.plugins.dnd=function(t,i){this.init=function(e,t){i.init.call(this,e,t);this.settings.dnd.use_html5=this.settings.dnd.use_html5&&"draggable"in d.createElement("span")};this.bind=function(){i.bind.call(this);this.element.on(this.settings.dnd.use_html5?"dragstart.jstree":"mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",e.proxy(function(t){if(this.settings.dnd.large_drag_target&&e(t.target).closest(".jstree-node")[0]!==t.currentTarget){return true}if(t.type==="touchstart"&&(!this.settings.dnd.touch||this.settings.dnd.touch==="selected"&&!e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked"))){return true}var i=this.get_node(t.target),r=this.is_selected(i)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,s=r>1?r+" "+this.get_string("nodes"):this.get_text(t.currentTarget);if(this.settings.core.force_text){s=e.vakata.html.escape(s)}if(i&&i.id&&i.id!==e.jstree.root&&(t.which===1||t.type==="touchstart"||t.type==="dragstart")&&(this.settings.dnd.is_draggable===true||e.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,r>1?this.get_top_selected(true):[i],t))){_={jstree:true,origin:this,obj:this.get_node(i,true),nodes:r>1?this.get_top_selected():[i.id]};u=t.currentTarget;if(this.settings.dnd.use_html5){e.vakata.dnd._trigger("start",t,{helper:e(),element:u,data:_})}else{this.element.trigger("mousedown.jstree");return e.vakata.dnd.start(t,_,'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+s+'<ins class="jstree-copy" style="display:none;">+</ins></div>')}}},this));if(this.settings.dnd.use_html5){this.element.on("dragover.jstree",function(t){t.preventDefault();e.vakata.dnd._trigger("move",t,{helper:e(),element:u,data:_});return false}).on("drop.jstree",e.proxy(function(t){t.preventDefault();e.vakata.dnd._trigger("stop",t,{helper:e(),element:u,data:_});return false},this))}};this.redraw_node=function(e,t,r,s){e=i.redraw_node.apply(this,arguments);if(e&&this.settings.dnd.use_html5){if(this.settings.dnd.large_drag_target){e.setAttribute("draggable",true)}else{var a,n,o=null;for(a=0,n=e.childNodes.length;a<n;a++){if(e.childNodes[a]&&e.childNodes[a].className&&e.childNodes[a].className.indexOf("jstree-anchor")!==-1){o=e.childNodes[a];break}}if(o){o.setAttribute("draggable",true)}}}return e}};e(function(){var i=false,r=false,s=false,a=false,n=e('<div id="jstree-marker">&#160;</div>').hide();e(d).on("dragover.vakata.jstree",function(t){if(u){e.vakata.dnd._trigger("move",t,{helper:e(),element:u,data:_})}}).on("drop.vakata.jstree",function(t){if(u){e.vakata.dnd._trigger("stop",t,{helper:e(),element:u,data:_});u=null;_=null}}).on("dnd_start.vakata.jstree",function(e,t){i=false;s=false;if(!t||!t.data||!t.data.jstree){return}n.appendTo(d.body)}).on("dnd_move.vakata.jstree",function(o,d){var l=d.event.target!==s.target;if(a){if(!d.event||d.event.type!=="dragover"||l){clearTimeout(a)}}if(!d||!d.data||!d.data.jstree){return}if(d.event.target.id&&d.event.target.id==="jstree-marker"){return}s=d.event;var h=e.jstree.reference(d.event.target),f=false,_=false,u=false,g,p,m,v,j,k,y,x,b,w,C,A,T,N,O,S,E,P;if(h&&h._data&&h._data.dnd){n.attr("class","jstree-"+h.get_theme()+(h.settings.core.themes.responsive?" jstree-dnd-responsive":""));S=d.data.origin&&(d.data.origin.settings.dnd.always_copy||d.data.origin.settings.dnd.copy&&(d.event.metaKey||d.event.ctrlKey));d.helper.children().attr("class","jstree-"+h.get_theme()+" jstree-"+h.get_theme()+"-"+h.get_theme_variant()+" "+(h.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[S?"show":"hide"]();if((d.event.target===h.element[0]||d.event.target===h.get_container_ul()[0])&&h.get_container_ul().children().length===0){x=true;for(b=0,w=d.data.nodes.length;b<w;b++){x=x&&h.check(d.data.origin&&(d.data.origin.settings.dnd.always_copy||d.data.origin.settings.dnd.copy&&(d.event.metaKey||d.event.ctrlKey))?"copy_node":"move_node",d.data.origin&&d.data.origin!==h?d.data.origin.get_node(d.data.nodes[b]):d.data.nodes[b],e.jstree.root,"last",{dnd:true,ref:h.get_node(e.jstree.root),pos:"i",origin:d.data.origin,is_multi:d.data.origin&&d.data.origin!==h,is_foreign:!d.data.origin});if(!x){break}}if(x){i={ins:h,par:e.jstree.root,pos:"last"};n.hide();d.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok");if(d.event.originalEvent&&d.event.originalEvent.dataTransfer){d.event.originalEvent.dataTransfer.dropEffect=S?"copy":"move"}return}}else{f=h.settings.dnd.large_drop_target?e(d.event.target).closest(".jstree-node").children(".jstree-anchor"):e(d.event.target).closest(".jstree-anchor");if(f&&f.length&&f.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")){_=f.offset();u=(d.event.pageY!==t?d.event.pageY:d.event.originalEvent.pageY)-_.top;v=f.outerHeight();if(u<v/3){y=["b","i","a"]}else if(u>v-v/3){y=["a","i","b"]}else{y=u>v/2?["i","a","b"]:["i","b","a"]}e.each(y,function(t,s){switch(s){case"b":p=_.left-6;m=_.top;j=h.get_parent(f);k=f.parent().index();P="jstree-below";break;case"i":N=h.settings.dnd.inside_pos;O=h.get_node(f.parent());p=_.left-2;m=_.top+v/2+1;j=O.id;k=N==="first"?0:N==="last"?O.children.length:Math.min(N,O.children.length);P="jstree-inside";break;case"a":p=_.left-6;m=_.top+v;j=h.get_parent(f);k=f.parent().index()+1;P="jstree-above";break}x=true;for(b=0,w=d.data.nodes.length;b<w;b++){C=d.data.origin&&(d.data.origin.settings.dnd.always_copy||d.data.origin.settings.dnd.copy&&(d.event.metaKey||d.event.ctrlKey))?"copy_node":"move_node";A=k;if(C==="move_node"&&s==="a"&&d.data.origin&&d.data.origin===h&&j===h.get_parent(d.data.nodes[b])){T=h.get_node(j);if(A>e.inArray(d.data.nodes[b],T.children)){A-=1}}x=x&&(h&&h.settings&&h.settings.dnd&&h.settings.dnd.check_while_dragging===false||h.check(C,d.data.origin&&d.data.origin!==h?d.data.origin.get_node(d.data.nodes[b]):d.data.nodes[b],j,A,{dnd:true,ref:h.get_node(f.parent()),pos:s,origin:d.data.origin,is_multi:d.data.origin&&d.data.origin!==h,is_foreign:!d.data.origin}));if(!x){if(h&&h.last_error){r=h.last_error()}break}}if(s==="i"&&f.parent().is(".jstree-closed")&&h.settings.dnd.open_timeout){if(!d.event||d.event.type!=="dragover"||l){if(a){clearTimeout(a)}a=setTimeout(function(e,t){return function(){e.open_node(t)}}(h,f),h.settings.dnd.open_timeout)}}if(x){E=h.get_node(j,true);if(!E.hasClass(".jstree-dnd-parent")){e(".jstree-dnd-parent").removeClass("jstree-dnd-parent");E.addClass("jstree-dnd-parent")}i={ins:h,par:j,pos:s==="i"&&N==="last"&&k===0&&!h.is_loaded(O)?"last":k};n.css({left:p+"px",top:m+"px"}).show();n.removeClass("jstree-above jstree-inside jstree-below").addClass(P);d.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok");if(d.event.originalEvent&&d.event.originalEvent.dataTransfer){d.event.originalEvent.dataTransfer.dropEffect=S?"copy":"move"}r={};y=true;return false}});if(y===true){return}}}}e(".jstree-dnd-parent").removeClass("jstree-dnd-parent");i=false;d.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er");if(d.event.originalEvent&&d.event.originalEvent.dataTransfer){}n.hide()}).on("dnd_scroll.vakata.jstree",function(e,t){if(!t||!t.data||!t.data.jstree){return}n.hide();i=false;s=false;t.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er")}).on("dnd_stop.vakata.jstree",function(t,o){e(".jstree-dnd-parent").removeClass("jstree-dnd-parent");if(a){clearTimeout(a)}if(!o||!o.data||!o.data.jstree){return}n.hide().detach();var d,l,h=[];if(i){for(d=0,l=o.data.nodes.length;d<l;d++){h[d]=o.data.origin?o.data.origin.get_node(o.data.nodes[d]):o.data.nodes[d]}i.ins[o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"copy_node":"move_node"](h,i.par,i.pos,false,false,false,o.data.origin)}else{d=e(o.event.target).closest(".jstree");if(d.length&&r&&r.error&&r.error==="check"){d=d.jstree(true);if(d){d.settings.core.error.call(this,r)}}}s=false;i=false}).on("keyup.jstree keydown.jstree",function(t,o){o=e.vakata.dnd._get();if(o&&o.data&&o.data.jstree){if(t.type==="keyup"&&t.which===27){if(a){clearTimeout(a)}i=false;r=false;s=false;a=false;n.hide().detach();e.vakata.dnd._clean()}else{o.helper.find(".jstree-copy").first()[o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(t.metaKey||t.ctrlKey))?"show":"hide"]();if(s){s.metaKey=t.metaKey;s.ctrlKey=t.ctrlKey;e.vakata.dnd._trigger("move",s)}}}})});(function(e){e.vakata.html={div:e("<div />"),escape:function(t){return e.vakata.html.div.text(t).html()},strip:function(t){return e.vakata.html.div.empty().append(e.parseHTML(t)).text()}};var i={element:false,target:false,is_down:false,is_drag:false,helper:false,helper_w:0,data:false,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:false,scroll_i:false,is_touch:false};e.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:10},_trigger:function(i,r,s){if(s===t){s=e.vakata.dnd._get()}s.event=r;e(d).triggerHandler("dnd_"+i+".vakata",s)},_get:function(){return{data:i.data,element:i.element,helper:i.helper}},_clean:function(){if(i.helper){i.helper.remove()}if(i.scroll_i){clearInterval(i.scroll_i);i.scroll_i=false}i={element:false,target:false,is_down:false,is_drag:false,helper:false,helper_w:0,data:false,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:false,scroll_i:false,is_touch:false};u=null;e(d).off("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag);e(d).off("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop)},_scroll:function(t){if(!i.scroll_e||!i.scroll_l&&!i.scroll_t){if(i.scroll_i){clearInterval(i.scroll_i);i.scroll_i=false}return false}if(!i.scroll_i){i.scroll_i=setInterval(e.vakata.dnd._scroll,100);return false}if(t===true){return false}var r=i.scroll_e.scrollTop(),s=i.scroll_e.scrollLeft();i.scroll_e.scrollTop(r+i.scroll_t*e.vakata.dnd.settings.scroll_speed);i.scroll_e.scrollLeft(s+i.scroll_l*e.vakata.dnd.settings.scroll_speed);if(r!==i.scroll_e.scrollTop()||s!==i.scroll_e.scrollLeft()){e.vakata.dnd._trigger("scroll",i.scroll_e)}},start:function(t,r,s){if(t.type==="touchstart"&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]){t.pageX=t.originalEvent.changedTouches[0].pageX;t.pageY=t.originalEvent.changedTouches[0].pageY;t.target=d.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)}if(i.is_drag){e.vakata.dnd.stop({})}try{t.currentTarget.unselectable="on";t.currentTarget.onselectstart=function(){return false};if(t.currentTarget.style){t.currentTarget.style.touchAction="none";t.currentTarget.style.msTouchAction="none";t.currentTarget.style.MozUserSelect="none"}}catch(e){}i.init_x=t.pageX;i.init_y=t.pageY;i.data=r;i.is_down=true;i.element=t.currentTarget;i.target=t.target;i.is_touch=t.type==="touchstart";if(s!==false){i.helper=e("<div id='vakata-dnd'></div>").html(s).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})}e(d).on("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag);e(d).on("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop);return false},drag:function(t){if(t.type==="touchmove"&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]){t.pageX=t.originalEvent.changedTouches[0].pageX;t.pageY=t.originalEvent.changedTouches[0].pageY;t.target=d.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)}if(!i.is_down){return}if(!i.is_drag){if(Math.abs(t.pageX-i.init_x)>(i.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)||Math.abs(t.pageY-i.init_y)>(i.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)){if(i.helper){i.helper.appendTo(d.body);i.helper_w=i.helper.outerWidth()}i.is_drag=true;e(i.target).one("click.vakata",false);e.vakata.dnd._trigger("start",t)}else{return}}var r=false,s=false,a=false,n=false,o=false,l=false,h=false,f=false,_=false,u=false;i.scroll_t=0;i.scroll_l=0;i.scroll_e=false;e(e(t.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test(e(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var r=e(this),s=r.offset();if(this.scrollHeight>this.offsetHeight){if(s.top+r.height()-t.pageY<e.vakata.dnd.settings.scroll_proximity){i.scroll_t=1}if(t.pageY-s.top<e.vakata.dnd.settings.scroll_proximity){i.scroll_t=-1}}if(this.scrollWidth>this.offsetWidth){if(s.left+r.width()-t.pageX<e.vakata.dnd.settings.scroll_proximity){i.scroll_l=1}if(t.pageX-s.left<e.vakata.dnd.settings.scroll_proximity){i.scroll_l=-1}}if(i.scroll_t||i.scroll_l){i.scroll_e=e(this);return false}});if(!i.scroll_e){r=e(d);s=e(window);a=r.height();n=s.height();o=r.width();l=s.width();h=r.scrollTop();f=r.scrollLeft();if(a>n&&t.pageY-h<e.vakata.dnd.settings.scroll_proximity){i.scroll_t=-1}if(a>n&&n-(t.pageY-h)<e.vakata.dnd.settings.scroll_proximity){i.scroll_t=1}if(o>l&&t.pageX-f<e.vakata.dnd.settings.scroll_proximity){i.scroll_l=-1}if(o>l&&l-(t.pageX-f)<e.vakata.dnd.settings.scroll_proximity){i.scroll_l=1}if(i.scroll_t||i.scroll_l){i.scroll_e=r}}if(i.scroll_e){e.vakata.dnd._scroll(true)}if(i.helper){_=parseInt(t.pageY+e.vakata.dnd.settings.helper_top,10);u=parseInt(t.pageX+e.vakata.dnd.settings.helper_left,10);if(a&&_+25>a){_=a-50}if(o&&u+i.helper_w>o){u=o-(i.helper_w+2)}i.helper.css({left:u+"px",top:_+"px"})}e.vakata.dnd._trigger("move",t);return false},stop:function(t){if(t.type==="touchend"&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]){t.pageX=t.originalEvent.changedTouches[0].pageX;t.pageY=t.originalEvent.changedTouches[0].pageY;t.target=d.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)}if(i.is_drag){if(t.target!==i.target){e(i.target).off("click.vakata")}e.vakata.dnd._trigger("stop",t)}else{if(t.type==="touchend"&&t.target===i.target){var r=setTimeout(function(){e(t.target).click()},100);e(t.target).one("click",function(){if(r){clearTimeout(r)}})}}e.vakata.dnd._clean();return false}}})(e);e.jstree.defaults.massload=null;e.jstree.plugins.massload=function(t,i){this.init=function(e,t){this._data.massload={};i.init.call(this,e,t)};this._load_nodes=function(t,r,s,a){var n=this.settings.massload,o=[],d=this._model.data,l,h,f;if(!s){for(l=0,h=t.length;l<h;l++){if(!d[t[l]]||!d[t[l]].state.loaded&&!d[t[l]].state.failed||a){o.push(t[l]);f=this.get_node(t[l],true);if(f&&f.length){f.addClass("jstree-loading").attr("aria-busy",true)}}}this._data.massload={};if(o.length){if(e.isFunction(n)){return n.call(this,o,e.proxy(function(e){var n,o;if(e){for(n in e){if(e.hasOwnProperty(n)){this._data.massload[n]=e[n]}}}for(n=0,o=t.length;n<o;n++){f=this.get_node(t[n],true);if(f&&f.length){f.removeClass("jstree-loading").attr("aria-busy",false)}}i._load_nodes.call(this,t,r,s,a)},this))}if(typeof n==="object"&&n&&n.url){n=e.extend(true,{},n);if(e.isFunction(n.url)){n.url=n.url.call(this,o)}if(e.isFunction(n.data)){n.data=n.data.call(this,o)}return e.ajax(n).done(e.proxy(function(e,n,o){var d,l;if(e){for(d in e){if(e.hasOwnProperty(d)){this._data.massload[d]=e[d]}}}for(d=0,l=t.length;d<l;d++){f=this.get_node(t[d],true);if(f&&f.length){f.removeClass("jstree-loading").attr("aria-busy",false)}}i._load_nodes.call(this,t,r,s,a)},this)).fail(e.proxy(function(e){i._load_nodes.call(this,t,r,s,a)},this))}}}return i._load_nodes.call(this,t,r,s,a)};this._load_node=function(t,r){var s=this._data.massload[t.id],a=null,n;if(s){a=this[typeof s==="string"?"_append_html_data":"_append_json_data"](t,typeof s==="string"?e(e.parseHTML(s)).filter(function(){return this.nodeType!==3}):s,function(e){r.call(this,e)});n=this.get_node(t.id,true);if(n&&n.length){n.removeClass("jstree-loading").attr("aria-busy",false)}delete this._data.massload[t.id];return a}return i._load_node.call(this,t,r)}};e.jstree.defaults.search={ajax:false,fuzzy:false,case_sensitive:false,show_only_matches:false,show_only_matches_children:false,close_opened_onclear:true,search_leaves_only:false,search_callback:false};e.jstree.plugins.search=function(i,r){this.bind=function(){r.bind.call(this);this._data.search.str="";this._data.search.dom=e();this._data.search.res=[];this._data.search.opn=[];this._data.search.som=false;this._data.search.smc=false;this._data.search.hdn=[];this.element.on("search.jstree",e.proxy(function(t,i){if(this._data.search.som&&i.res.length){var r=this._model.data,s,a,n=[],o,d;for(s=0,a=i.res.length;s<a;s++){if(r[i.res[s]]&&!r[i.res[s]].state.hidden){n.push(i.res[s]);n=n.concat(r[i.res[s]].parents);if(this._data.search.smc){for(o=0,d=r[i.res[s]].children_d.length;o<d;o++){if(r[r[i.res[s]].children_d[o]]&&!r[r[i.res[s]].children_d[o]].state.hidden){n.push(r[i.res[s]].children_d[o])}}}}}n=e.vakata.array_remove_item(e.vakata.array_unique(n),e.jstree.root);this._data.search.hdn=this.hide_all(true);this.show_node(n,true);this.redraw(true)}},this)).on("clear_search.jstree",e.proxy(function(e,t){if(this._data.search.som&&t.res.length){this.show_node(this._data.search.hdn,true);this.redraw(true)}},this))};this.search=function(i,r,s,a,n,o){if(i===false||e.trim(i.toString())===""){return this.clear_search()}a=this.get_node(a);a=a&&a.id?a.id:null;i=i.toString();var d=this.settings.search,l=d.ajax?d.ajax:false,h=this._model.data,f=null,_=[],u=[],g,p;if(this._data.search.res.length&&!n){this.clear_search()}if(s===t){s=d.show_only_matches}if(o===t){o=d.show_only_matches_children}if(!r&&l!==false){if(e.isFunction(l)){return l.call(this,i,e.proxy(function(t){if(t&&t.d){t=t.d}this._load_nodes(!e.isArray(t)?[]:e.vakata.array_unique(t),function(){this.search(i,true,s,a,n,o)})},this),a)}else{l=e.extend({},l);if(!l.data){l.data={}}l.data.str=i;if(a){l.data.inside=a}if(this._data.search.lastRequest){this._data.search.lastRequest.abort()}this._data.search.lastRequest=e.ajax(l).fail(e.proxy(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(l)};this.settings.core.error.call(this,this._data.core.last_error)},this)).done(e.proxy(function(t){if(t&&t.d){t=t.d}this._load_nodes(!e.isArray(t)?[]:e.vakata.array_unique(t),function(){this.search(i,true,s,a,n,o)})},this));return this._data.search.lastRequest}}if(!n){this._data.search.str=i;this._data.search.dom=e();this._data.search.res=[];this._data.search.opn=[];this._data.search.som=s;this._data.search.smc=o}f=new e.vakata.search(i,true,{caseSensitive:d.case_sensitive,fuzzy:d.fuzzy});e.each(h[a?a:e.jstree.root].children_d,function(e,t){var r=h[t];if(r.text&&!r.state.hidden&&(!d.search_leaves_only||r.state.loaded&&r.children.length===0)&&(d.search_callback&&d.search_callback.call(this,i,r)||!d.search_callback&&f.search(r.text).isMatch)){_.push(t);u=u.concat(r.parents)}});if(_.length){u=e.vakata.array_unique(u);for(g=0,p=u.length;g<p;g++){if(u[g]!==e.jstree.root&&h[u[g]]&&this.open_node(u[g],null,0)===true){this._data.search.opn.push(u[g])}}if(!n){this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(_,function(t){return"0123456789".indexOf(t[0])!==-1?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #")));this._data.search.res=_}else{this._data.search.dom=this._data.search.dom.add(e(this.element[0].querySelectorAll("#"+e.map(_,function(t){return"0123456789".indexOf(t[0])!==-1?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))));this._data.search.res=e.vakata.array_unique(this._data.search.res.concat(_))}this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:i,res:this._data.search.res,show_only_matches:s})};this.clear_search=function(){if(this.settings.search.close_opened_onclear){this.close_node(this._data.search.opn,0)}this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res});if(this._data.search.res.length){this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(this._data.search.res,function(t){return"0123456789".indexOf(t[0])!==-1?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #")));this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search")}this._data.search.str="";this._data.search.res=[];this._data.search.opn=[];this._data.search.dom=e()};this.redraw_node=function(t,i,s,a){t=r.redraw_node.apply(this,arguments);if(t){if(e.inArray(t.id,this._data.search.res)!==-1){var n,o,d=null;for(n=0,o=t.childNodes.length;n<o;n++){if(t.childNodes[n]&&t.childNodes[n].className&&t.childNodes[n].className.indexOf("jstree-anchor")!==-1){d=t.childNodes[n];break}}if(d){d.className+=" jstree-search"}}}return t}};(function(e){e.vakata.search=function(t,i,r){r=r||{};r=e.extend({},e.vakata.search.defaults,r);if(r.fuzzy!==false){r.fuzzy=true}t=r.caseSensitive?t:t.toLowerCase();var s=r.location,a=r.distance,n=r.threshold,o=t.length,d,l,h,f;if(o>32){r.fuzzy=false}if(r.fuzzy){d=1<<o-1;l=function(){var e={},i=0;for(i=0;i<o;i++){e[t.charAt(i)]=0}for(i=0;i<o;i++){e[t.charAt(i)]|=1<<o-i-1}return e}();h=function(e,t){var i=e/o,r=Math.abs(s-t);if(!a){return r?1:i}return i+r/a}}f=function(e){e=r.caseSensitive?e:e.toLowerCase();if(t===e||e.indexOf(t)!==-1){return{isMatch:true,score:0}}if(!r.fuzzy){return{isMatch:false,score:1}}var i,a,f=e.length,_=n,u=e.indexOf(t,s),g,p,m=o+f,v,j,k,y,x,b=1,w=[];if(u!==-1){_=Math.min(h(0,u),_);u=e.lastIndexOf(t,s+o);if(u!==-1){_=Math.min(h(0,u),_)}}u=-1;for(i=0;i<o;i++){g=0;p=m;while(g<p){if(h(i,s+p)<=_){g=p}else{m=p}p=Math.floor((m-g)/2+g)}m=p;j=Math.max(1,s-p+1);k=Math.min(s+p,f)+o;y=new Array(k+2);y[k+1]=(1<<i)-1;for(a=k;a>=j;a--){x=l[e.charAt(a-1)];if(i===0){y[a]=(y[a+1]<<1|1)&x}else{y[a]=(y[a+1]<<1|1)&x|((v[a+1]|v[a])<<1|1)|v[a+1]}if(y[a]&d){b=h(i,a-1);if(b<=_){_=b;u=a-1;w.push(u);if(u>s){j=Math.max(1,2*s-u)}else{break}}}}if(h(i+1,s)>_){break}v=y}return{isMatch:u>=0,score:b}};return i===true?{search:f}:f(i)};e.vakata.search.defaults={location:0,distance:100,threshold:.6,fuzzy:false,caseSensitive:false}})(e);e.jstree.defaults.sort=function(e,t){return this.get_text(e)>this.get_text(t)?1:-1};e.jstree.plugins.sort=function(t,i){this.bind=function(){i.bind.call(this);this.element.on("model.jstree",e.proxy(function(e,t){this.sort(t.parent,true)},this)).on("rename_node.jstree create_node.jstree",e.proxy(function(e,t){this.sort(t.parent||t.node.parent,false);this.redraw_node(t.parent||t.node.parent,true)},this)).on("move_node.jstree copy_node.jstree",e.proxy(function(e,t){this.sort(t.parent,false);this.redraw_node(t.parent,true)},this))};this.sort=function(t,i){var r,s;t=this.get_node(t);if(t&&t.children&&t.children.length){t.children.sort(e.proxy(this.settings.sort,this));if(i){for(r=0,s=t.children_d.length;r<s;r++){this.sort(t.children_d[r],false)}}}}};var g=false;e.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",ttl:false,filter:false,preserve_loaded:false};e.jstree.plugins.state=function(t,i){this.bind=function(){i.bind.call(this);var t=e.proxy(function(){this.element.on(this.settings.state.events,e.proxy(function(){if(g){clearTimeout(g)}g=setTimeout(e.proxy(function(){this.save_state()},this),100)},this));this.trigger("state_ready")},this);this.element.on("ready.jstree",e.proxy(function(e,i){this.element.one("restore_state.jstree",t);if(!this.restore_state()){t()}},this))};this.save_state=function(){var t=this.get_state();if(!this.settings.state.preserve_loaded){delete t.core.loaded}var i={state:t,ttl:this.settings.state.ttl,sec:+new Date};e.vakata.storage.set(this.settings.state.key,JSON.stringify(i))};this.restore_state=function(){var t=e.vakata.storage.get(this.settings.state.key);if(!!t){try{t=JSON.parse(t)}catch(e){return false}}if(!!t&&t.ttl&&t.sec&&+new Date-t.sec>t.ttl){return false}if(!!t&&t.state){t=t.state}if(!!t&&e.isFunction(this.settings.state.filter)){t=this.settings.state.filter.call(this,t)}if(!!t){if(!this.settings.state.preserve_loaded){delete t.core.loaded}this.element.one("set_state.jstree",function(i,r){r.instance.trigger("restore_state",{state:e.extend(true,{},t)})});this.set_state(t);return true}return false};this.clear_state=function(){return e.vakata.storage.del(this.settings.state.key)}};(function(e,t){e.vakata.storage={set:function(e,t){return window.localStorage.setItem(e,t)},get:function(e){return window.localStorage.getItem(e)},del:function(e){return window.localStorage.removeItem(e)}}})(e);e.jstree.defaults.types={default:{}};e.jstree.defaults.types[e.jstree.root]={};e.jstree.plugins.types=function(i,r){this.init=function(i,s){var a,n;if(s&&s.types&&s.types["default"]){for(a in s.types){if(a!=="default"&&a!==e.jstree.root&&s.types.hasOwnProperty(a)){for(n in s.types["default"]){if(s.types["default"].hasOwnProperty(n)&&s.types[a][n]===t){s.types[a][n]=s.types["default"][n]}}}}}r.init.call(this,i,s);this._model.data[e.jstree.root].type=e.jstree.root};this.refresh=function(t,i){r.refresh.call(this,t,i);this._model.data[e.jstree.root].type=e.jstree.root};this.bind=function(){this.element.on("model.jstree",e.proxy(function(i,r){var s=this._model.data,a=r.nodes,n=this.settings.types,o,d,l="default",h;for(o=0,d=a.length;o<d;o++){l="default";if(s[a[o]].original&&s[a[o]].original.type&&n[s[a[o]].original.type]){l=s[a[o]].original.type}if(s[a[o]].data&&s[a[o]].data.jstree&&s[a[o]].data.jstree.type&&n[s[a[o]].data.jstree.type]){l=s[a[o]].data.jstree.type}s[a[o]].type=l;if(s[a[o]].icon===true&&n[l].icon!==t){s[a[o]].icon=n[l].icon}if(n[l].li_attr!==t&&typeof n[l].li_attr==="object"){for(h in n[l].li_attr){if(n[l].li_attr.hasOwnProperty(h)){if(h==="id"){continue}else if(s[a[o]].li_attr[h]===t){s[a[o]].li_attr[h]=n[l].li_attr[h]}else if(h==="class"){s[a[o]].li_attr["class"]=n[l].li_attr["class"]+" "+s[a[o]].li_attr["class"]}}}}if(n[l].a_attr!==t&&typeof n[l].a_attr==="object"){for(h in n[l].a_attr){if(n[l].a_attr.hasOwnProperty(h)){if(h==="id"){continue}else if(s[a[o]].a_attr[h]===t){s[a[o]].a_attr[h]=n[l].a_attr[h]}else if(h==="href"&&s[a[o]].a_attr[h]==="#"){s[a[o]].a_attr["href"]=n[l].a_attr["href"]}else if(h==="class"){s[a[o]].a_attr["class"]=n[l].a_attr["class"]+" "+s[a[o]].a_attr["class"]}}}}}s[e.jstree.root].type=e.jstree.root},this));r.bind.call(this)};this.get_json=function(t,i,s){var a,n,o=this._model.data,d=i?e.extend(true,{},i,{no_id:false}):{},l=r.get_json.call(this,t,d,s);if(l===false){return false}if(e.isArray(l)){for(a=0,n=l.length;a<n;a++){l[a].type=l[a].id&&o[l[a].id]&&o[l[a].id].type?o[l[a].id].type:"default";if(i&&i.no_id){delete l[a].id;if(l[a].li_attr&&l[a].li_attr.id){delete l[a].li_attr.id}if(l[a].a_attr&&l[a].a_attr.id){delete l[a].a_attr.id}}}}else{l.type=l.id&&o[l.id]&&o[l.id].type?o[l.id].type:"default";if(i&&i.no_id){l=this._delete_ids(l)}}return l};this._delete_ids=function(t){if(e.isArray(t)){for(var i=0,r=t.length;i<r;i++){t[i]=this._delete_ids(t[i])}return t}delete t.id;if(t.li_attr&&t.li_attr.id){delete t.li_attr.id}if(t.a_attr&&t.a_attr.id){delete t.a_attr.id}if(t.children&&e.isArray(t.children)){t.children=this._delete_ids(t.children)}return t};this.check=function(i,s,a,n,o){if(r.check.call(this,i,s,a,n,o)===false){return false}s=s&&s.id?s:this.get_node(s);a=a&&a.id?a:this.get_node(a);var d=s&&s.id?o&&o.origin?o.origin:e.jstree.reference(s.id):null,l,h,f,_;d=d&&d._model&&d._model.data?d._model.data:null;switch(i){case"create_node":case"move_node":case"copy_node":if(i!=="move_node"||e.inArray(s.id,a.children)===-1){l=this.get_rules(a);if(l.max_children!==t&&l.max_children!==-1&&l.max_children===a.children.length){this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+i,data:JSON.stringify({chk:i,pos:n,obj:s&&s.id?s.id:false,par:a&&a.id?a.id:false})};return false}if(l.valid_children!==t&&l.valid_children!==-1&&e.inArray(s.type||"default",l.valid_children)===-1){this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+i,data:JSON.stringify({chk:i,pos:n,obj:s&&s.id?s.id:false,par:a&&a.id?a.id:false})};return false}if(d&&s.children_d&&s.parents){h=0;for(f=0,_=s.children_d.length;f<_;f++){h=Math.max(h,d[s.children_d[f]].parents.length)}h=h-s.parents.length+1}if(h<=0||h===t){h=1}do{if(l.max_depth!==t&&l.max_depth!==-1&&l.max_depth<h){this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+i,data:JSON.stringify({chk:i,pos:n,obj:s&&s.id?s.id:false,par:a&&a.id?a.id:false})};return false}a=this.get_node(a.parent);l=this.get_rules(a);h++}while(a)}break}return true};this.get_rules=function(e){e=this.get_node(e);if(!e){return false}var i=this.get_type(e,true);if(i.max_depth===t){i.max_depth=-1}if(i.max_children===t){i.max_children=-1}if(i.valid_children===t){i.valid_children=-1}return i};this.get_type=function(t,i){t=this.get_node(t);return!t?false:i?e.extend({type:t.type},this.settings.types[t.type]):t.type};this.set_type=function(i,r){var s=this._model.data,a,n,o,d,l,h,f,_;if(e.isArray(i)){i=i.slice();for(n=0,o=i.length;n<o;n++){this.set_type(i[n],r)}return true}a=this.settings.types;i=this.get_node(i);if(!a[r]||!i){return false}f=this.get_node(i,true);if(f&&f.length){_=f.children(".jstree-anchor")}d=i.type;l=this.get_icon(i);i.type=r;if(l===true||!a[d]||a[d].icon!==t&&l===a[d].icon){this.set_icon(i,a[r].icon!==t?a[r].icon:true)}if(a[d]&&a[d].li_attr!==t&&typeof a[d].li_attr==="object"){for(h in a[d].li_attr){if(a[d].li_attr.hasOwnProperty(h)){if(h==="id"){continue}else if(h==="class"){s[i.id].li_attr["class"]=(s[i.id].li_attr["class"]||"").replace(a[d].li_attr[h],"");if(f){f.removeClass(a[d].li_attr[h])}}else if(s[i.id].li_attr[h]===a[d].li_attr[h]){s[i.id].li_attr[h]=null;if(f){f.removeAttr(h)}}}}}if(a[d]&&a[d].a_attr!==t&&typeof a[d].a_attr==="object"){for(h in a[d].a_attr){if(a[d].a_attr.hasOwnProperty(h)){if(h==="id"){continue}else if(h==="class"){s[i.id].a_attr["class"]=(s[i.id].a_attr["class"]||"").replace(a[d].a_attr[h],"");if(_){_.removeClass(a[d].a_attr[h])}}else if(s[i.id].a_attr[h]===a[d].a_attr[h]){if(h==="href"){s[i.id].a_attr[h]="#";if(_){_.attr("href","#")}}else{delete s[i.id].a_attr[h];if(_){_.removeAttr(h)}}}}}}if(a[r].li_attr!==t&&typeof a[r].li_attr==="object"){for(h in a[r].li_attr){if(a[r].li_attr.hasOwnProperty(h)){if(h==="id"){continue}else if(s[i.id].li_attr[h]===t){s[i.id].li_attr[h]=a[r].li_attr[h];if(f){if(h==="class"){f.addClass(a[r].li_attr[h])}else{f.attr(h,a[r].li_attr[h])}}}else if(h==="class"){s[i.id].li_attr["class"]=a[r].li_attr[h]+" "+s[i.id].li_attr["class"];if(f){f.addClass(a[r].li_attr[h])}}}}}if(a[r].a_attr!==t&&typeof a[r].a_attr==="object"){for(h in a[r].a_attr){if(a[r].a_attr.hasOwnProperty(h)){if(h==="id"){continue}else if(s[i.id].a_attr[h]===t){s[i.id].a_attr[h]=a[r].a_attr[h];if(_){if(h==="class"){_.addClass(a[r].a_attr[h])}else{_.attr(h,a[r].a_attr[h])}}}else if(h==="href"&&s[i.id].a_attr[h]==="#"){s[i.id].a_attr["href"]=a[r].a_attr["href"];if(_){_.attr("href",a[r].a_attr["href"])}}else if(h==="class"){s[i.id].a_attr["class"]=a[r].a_attr["class"]+" "+s[i.id].a_attr["class"];if(_){_.addClass(a[r].a_attr[h])}}}}}return true}};e.jstree.defaults.unique={case_sensitive:false,trim_whitespace:false,duplicate:function(e,t){return e+" ("+t+")"}};e.jstree.plugins.unique=function(i,r){this.check=function(t,i,s,a,n){if(r.check.call(this,t,i,s,a,n)===false){return false}i=i&&i.id?i:this.get_node(i);s=s&&s.id?s:this.get_node(s);if(!s||!s.children){return true}var o=t==="rename_node"?a:i.text,d=[],l=this.settings.unique.case_sensitive,h=this.settings.unique.trim_whitespace,f=this._model.data,_,u,g;for(_=0,u=s.children.length;_<u;_++){g=f[s.children[_]].text;if(!l){g=g.toLowerCase()}if(h){g=g.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}d.push(g)}if(!l){o=o.toLowerCase()}if(h){o=o.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}switch(t){case"delete_node":return true;case"rename_node":g=i.text||"";if(!l){g=g.toLowerCase()}if(h){g=g.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}_=e.inArray(o,d)===-1||i.text&&g===o;if(!_){this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+o+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:a,obj:i&&i.id?i.id:false,par:s&&s.id?s.id:false})}}return _;case"create_node":_=e.inArray(o,d)===-1;if(!_){this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+o+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:a,obj:i&&i.id?i.id:false,par:s&&s.id?s.id:false})}}return _;case"copy_node":_=e.inArray(o,d)===-1;if(!_){this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+o+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:a,obj:i&&i.id?i.id:false,par:s&&s.id?s.id:false})}}return _;case"move_node":_=i.parent===s.id&&(!n||!n.is_multi)||e.inArray(o,d)===-1;if(!_){this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+o+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:a,obj:i&&i.id?i.id:false,par:s&&s.id?s.id:false})}}return _}return true};this.create_node=function(i,s,a,n,o){if(!s||s.text===t){if(i===null){i=e.jstree.root}i=this.get_node(i);if(!i){return r.create_node.call(this,i,s,a,n,o)}a=a===t?"last":a;if(!a.toString().match(/^(before|after)$/)&&!o&&!this.is_loaded(i)){return r.create_node.call(this,i,s,a,n,o)}if(!s){s={}}var d,l,h,f,_,u=this._model.data,g=this.settings.unique.case_sensitive,p=this.settings.unique.trim_whitespace,m=this.settings.unique.duplicate,v;l=d=this.get_string("New node");h=[];for(f=0,_=i.children.length;f<_;f++){v=u[i.children[f]].text;if(!g){v=v.toLowerCase()}if(p){v=v.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}h.push(v)}f=1;v=l;if(!g){v=v.toLowerCase()}if(p){v=v.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}while(e.inArray(v,h)!==-1){l=m.call(this,d,++f).toString();v=l;if(!g){v=v.toLowerCase()}if(p){v=v.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}}s.text=l}return r.create_node.call(this,i,s,a,n,o)}};var p=d.createElement("DIV");p.setAttribute("unselectable","on");p.setAttribute("role","presentation");p.className="jstree-wholerow";p.innerHTML="&#160;";e.jstree.plugins.wholerow=function(t,i){this.bind=function(){i.bind.call(this);this.element.on("ready.jstree set_state.jstree",e.proxy(function(){this.hide_dots()},this)).on("init.jstree loading.jstree ready.jstree",e.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",e.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree",e.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");var i=false,r,s;for(r=0,s=t.selected.length;r<s;r++){i=this.get_node(t.selected[r],true);if(i&&i.length){i.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")}}},this)).on("open_node.jstree",e.proxy(function(e,t){this.get_node(t.node,true).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",e.proxy(function(e,t){if(e.type==="hover_node"&&this.is_disabled(t.node)){return}this.get_node(t.node,true).children(".jstree-wholerow")[e.type==="hover_node"?"addClass":"removeClass"]("jstree-wholerow-hovered")},this)).on("contextmenu.jstree",".jstree-wholerow",e.proxy(function(t){if(this._data.contextmenu){t.preventDefault();var i=e.Event("contextmenu",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,pageX:t.pageX,pageY:t.pageY});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(i)}},this)).on("click.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var i=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(i).focus()}).on("dblclick.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var i=e.Event("dblclick",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(i).focus()}).on("click.jstree",".jstree-leaf > .jstree-ocl",e.proxy(function(t){t.stopImmediatePropagation();var i=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(i).focus()},this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",e.proxy(function(e){e.stopImmediatePropagation();if(!this.is_disabled(e.currentTarget)){this.hover_node(e.currentTarget)}return false},this)).on("mouseleave.jstree",".jstree-node",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))};this.teardown=function(){if(this.settings.wholerow){this.element.find(".jstree-wholerow").remove()}i.teardown.call(this)};this.redraw_node=function(t,r,s,a){t=i.redraw_node.apply(this,arguments);if(t){var n=p.cloneNode(true);if(e.inArray(t.id,this._data.core.selected)!==-1){n.className+=" jstree-wholerow-clicked"}if(this._data.core.focused&&this._data.core.focused===t.id){n.className+=" jstree-wholerow-hovered"}t.insertBefore(n,t.childNodes[0])}return t}};if(window.customElements&&Object&&Object.create){var m=Object.create(HTMLElement.prototype);m.createdCallback=function(){var t={core:{},plugins:[]},i;for(i in e.jstree.plugins){if(e.jstree.plugins.hasOwnProperty(i)&&this.attributes[i]){t.plugins.push(i);if(this.getAttribute(i)&&JSON.parse(this.getAttribute(i))){t[i]=JSON.parse(this.getAttribute(i))}}}for(i in e.jstree.defaults.core){if(e.jstree.defaults.core.hasOwnProperty(i)&&this.attributes[i]){t.core[i]=JSON.parse(this.getAttribute(i))||this.getAttribute(i)}}e(this).jstree(t)};try{window.customElements.define("vakata-jstree",function(){},{prototype:m})}catch(e){}}})}};var __webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(t!==undefined){return t.exports}var i=__webpack_module_cache__[e]={exports:{}};__webpack_modules__[e](i,i.exports,__webpack_require__);return i.exports}var __webpack_exports__=__webpack_require__(695);